

tic
clear all
close all
clc
 
span = 42.4;                    % wing span
c = 6;                          % mean aerodynamic chord
Sw = 222;                       % reference surface (wing surface)

V = 27.778;                     % reference speed
ro = 1.225;                     % air density
AL = 0*pi/180;                  % angle of attack
BETA = 0*pi/180;                % sideslip angle
Vx = V*cos(AL)*cos(BETA);
Vy = V*sin(BETA);
Vz = V*cos(BETA)*sin(AL);


farpoint = 1000;                % farpoint distance for trailing wake
error = 0.000001;               % minimal distance (error)
farfieldfaktor = 5;             % "far field" distance in longer panel diagonal

// komp - components ID                                      
//M1 - lateral number of nodes                              
//N1 - longitudinal number of nodes                         
//x,y,z - panel coordinates (nodes)                         
//lift - 1 for lifting component, 0 for non-lifting        
//komp = 0;

% left wing
komp = komp+1;
M1(komp) = 6;
N1(komp) = 25;
x(1:N1(komp),1:M1(komp),komp) = [7.13329656669040,6.97852426678375,6.57332512511115,6.07247144157925,5.66727229990665,5.51250000000000;7.08928781123905,6.92676027115049,6.50125764709073,5.97530747914832,5.54980485508856,5.38727731500000;6.96051778447303,6.77522851322873,6.29013490336048,5.69052622611255,5.20543261624429,5.02014334500000;6.75639747692291,6.53483045402581,5.95476045729508,5.23775450962783,4.65768451289710,4.43611749000000;6.49049029298218,6.22163489375123,5.51776232050568,4.64772797247649,3.94385539923095,3.67500000000000;6.18012314862116,5.85626728930126,5.00840164214597,3.96038206647518,3.11251641931990,2.78866056000000;5.84521564623371,5.46251285632958,4.46058394477115,3.22213170146256,2.22020278990413,1.83750000000000;5.50905975235823,5.06762931283541,3.91194941849585,2.48345050886238,1.32777061452282,0.886340175000000;5.19487226212312,4.69880610289387,3.40008803736309,1.79478422476002,0.496066159229244,0;4.92421344647257,4.38131265136225,2.95997991724411,1.20311603922846,-0.218216694889687,-0.761117490000000;4.71565655815531,4.13690166715699,2.62170169136817,0.748811521787141,-0.766388454001686,-1.34514334500000;4.58369034209323,3.98247892885834,2.40848701458503,0.462926012508200,-1.11106590176511,-1.71227731500000;4.53685977632851,3.92816258181918,2.33457263773705,0.364787138591455,-1.22880280549067,-1.83750000000000;4.57850071704593,3.97778486890584,2.40509036089436,0.461133041151576,-1.11156146685991,-1.71227731500000;4.70591957491572,4.12809448307982,2.61532875310089,0.745447476814838,-0.767318253164094,-1.34514334500000;4.90998478631127,4.36844270734277,2.95066713826495,1.19820015804632,-0.219575411031498,-0.761117490000000;5.17706568571484,4.68269990322677,3.38843348179806,1.78863220391678,0.494365782488072,0;5.48908941701600,5.04956597482667,3.89887866432267,2.47655092769332,1.32586361718932,0.886340175000000;5.82494069678519,5.44417399227335,4.44731381807705,3.21512687870814,2.21826670451185,1.83750000000000;6.16204088732978,5.83991173031485,4.99656664848240,3.95413479884738,3.11078971701493,2.78866056000000;6.47788444521767,6.21023279733398,5.50951168602957,4.64337275918811,3.94265164788369,3.67500000000000;6.74971697633106,6.52878788447502,5.95038801289226,5.23544645343881,4.65704658185604,4.43611749000000;6.95821876849375,6.77314903374031,6.28863017786687,5.68973193562688,5.20521307975344,5.02014334500000;7.08883381565959,6.92634962829118,6.50096050312629,5.97515062753331,5.54976150236841,5.38727731500000;7.13329656669040,6.97852426678375,6.57332512511115,6.07247144157925,5.66727229990665,5.51250000000000;];
y(1:N1(komp),1:M1(komp),komp) = [-21.2000000000000,-19.4620546488120,-14.9120546488120,-9.28794535118798,-4.73794535118798,-3;-21.2000000000000,-19.4620542475926,-14.9120531971864,-9.28794260118895,-4.73794155078278,-2.99999579837536;-21.2000000000000,-19.4620542972928,-14.9120533770034,-9.28794294183922,-4.73794202154989,-2.99999631884266;-21.2000000000000,-19.4619217007316,-14.9115736381382,-9.28703411148833,-4.73668604889496,-2.99860774962653;-21.2000000000000,-19.4612057869930,-14.9089834378989,-9.28212716572482,-4.72990481663074,-2.99111060362369;-21.2000000000000,-19.4598502798909,-14.9040791671315,-9.27283638183105,-4.71706526907168,-2.97691554896254;-21.2000000000000,-19.4590858452559,-14.9013134166400,-9.26759686889640,-4.70982444028049,-2.96891028553637;-21.2000000000000,-19.4590651826357,-14.9012386585777,-9.26745524519054,-4.70962872113260,-2.96869390376826;-21.2000000000000,-19.4595761333833,-14.9030872957492,-9.27095735371451,-4.71446851608044,-2.97404464946373;-21.2000000000000,-19.4603681296863,-14.9059527652924,-9.27638577713213,-4.72197041273826,-2.98233854242454;-21.2000000000000,-19.4611742943556,-14.9088694964666,-9.28191131197728,-4.72960651408825,-2.99078080844386;-21.2000000000000,-19.4617466243435,-14.9109402058154,-9.28583412007234,-4.73502770154427,-2.99677432588772;-21.2000000000000,-19.4620546488120,-14.9120546488120,-9.28794535118798,-4.73794535118798,-3;-21.2000000000000,-19.4616018970938,-14.9104165777069,-9.28484214474573,-4.73365682535889,-2.99525872245267;-21.2000000000000,-19.4601825741013,-14.9052814188791,-9.27511396023224,-4.72021280501009,-2.98039537911139;-21.2000000000000,-19.4577501717704,-14.8964809045718,-9.25844202663362,-4.69717275943497,-2.95492293120542;-21.2000000000000,-19.4550122173701,-14.8865748924916,-9.23967580799461,-4.67123848311616,-2.92625070048625;-21.2000000000000,-19.4529401637254,-14.8790781319786,-9.22547374103428,-4.65161170928750,-2.90455187301289;-21.2000000000000,-19.4524526047548,-14.8773141270515,-9.22213196213527,-4.64699348443196,-2.89944608918675;-21.2000000000000,-19.4541573613453,-14.8834819943386,-9.23381653763457,-4.66314117062788,-2.91729853197322;-21.2000000000000,-19.4577881612704,-14.8966183518737,-9.25870241053974,-4.69753260114310,-2.95532076241347;-21.2000000000000,-19.4605748598795,-14.9067007221579,-9.27780272695571,-4.72392858923410,-2.98450344911356;-21.2000000000000,-19.4617779660048,-14.9110536010114,-9.28604893901496,-4.73532457402154,-2.99710254002634;-21.2000000000000,-19.4620382747079,-14.9119954067468,-9.28783312140881,-4.73779025344772,-2.99982852815563;-21.2000000000000,-19.4620546488120,-14.9120546488120,-9.28794535118798,-4.73794535118798,-3;];
z(1:N1(komp),1:M1(komp),komp) = [-3.91893678709257,-3.78344038089712,-3.42870618412398,-2.99023060296859,-2.63549640619545,-2.50000000000000;-3.92558646053853,-3.78901738554903,-3.43147490541440,-2.98952809512413,-2.63198561498950,-2.49541654000000;-3.94998590161075,-3.81193424597688,-3.45051031932419,-3.00376577728657,-2.64234185063388,-2.50429019500000;-4.00260005896907,-3.86708066110530,-3.51228627136303,-3.07373628760604,-2.71894189786377,-2.58342250000000;-4.07322211078005,-3.94310681418389,-3.60246054523888,-3.18139860054117,-2.84075233159616,-2.71063703500000;-4.14187936444657,-4.01746099984116,-3.69172949247952,-3.28910320696705,-2.96337169960541,-2.83895333500000;-4.18040807109036,-4.05747554885971,-3.73563402733712,-3.33781602875324,-3.01597450723065,-2.89304198500000;-4.19511108120740,-4.07090411027074,-3.74572603871889,-3.34378383748851,-3.01860576593666,-2.89439879500000;-4.19087676095969,-4.06372336964758,-3.73083146940766,-3.31935445155203,-2.98646255131211,-2.85930916000000;-4.17083227862594,-4.03960860424556,-3.69606056458908,-3.27141183403687,-2.92786379438038,-2.79664012000000;-4.13879143194026,-4.00278386165463,-3.64671141991957,-3.20658167702069,-2.85050923528563,-2.71450166500000;-4.10220394817471,-3.96133035710274,-3.59251850755906,-3.13664199061565,-2.76783014107197,-2.62695655000000;-4.05501027332422,-3.90652000543558,-3.51776743710452,-3.03724283621970,-2.64849026788865,-2.50000000000000;-4.00318000328918,-3.84494334742356,-3.43067440410127,-2.91860982918791,-2.50434088586561,-2.34610423000000;-3.95299872381969,-3.78441126932080,-3.34304358336588,-2.79748312045382,-2.35611543449889,-2.18752798000000;-3.89933326920496,-3.72057928126506,-3.25259526521382,-2.67413520899114,-2.20615119293990,-2.02739720500000;-3.85110704257293,-3.66453029920663,-3.17606604356340,-2.57229101900953,-2.08382676336630,-1.89725002000000;-3.81405438284238,-3.62323802346458,-3.12367430900399,-2.50617959883840,-2.00661588437780,-1.81579952500000;-3.79353898932643,-3.60299187144130,-3.10413304035969,-2.48750961396674,-1.98865078288513,-1.79810366500000;-3.79684926512254,-3.61211576056954,-3.12847716678890,-2.53066698833363,-2.04702839455300,-1.86229489000000;-3.83268820652092,-3.66049604063713,-3.20969109775690,-2.65246554376402,-2.20166060088379,-2.02946843500000;-3.87512851403361,-3.71727589722869,-3.30401238122029,-2.79319058281333,-2.37992706680492,-2.22207445000000;-3.90611806346287,-3.76035540434326,-3.37874380847754,-2.90704593498533,-2.52543433911962,-2.37967168000000;-3.91692370883116,-3.77882352468098,-3.41727254872319,-2.97037096510797,-2.60881998915018,-2.47071980500000;-3.91893678709257,-3.78344038089712,-3.42870618412398,-2.99023060296859,-2.63549640619545,-2.50000000000000;];
lift(komp) = 1;

% right wing
komp = komp+1;
M1(komp) = 6;
N1(komp) = 25;
x(1:N1(komp),1:M1(komp),komp) = [5.51250000000000,5.66727229990665,6.07247144157925,6.57332512511115,6.97852426678375,7.13329656669040;5.38727731500000,5.54980485508856,5.97530747914832,6.50125764709073,6.92676027115049,7.08928781123905;5.02014334500000,5.20543261624429,5.69052622611255,6.29013490336048,6.77522851322873,6.96051778447303;4.43611749000000,4.65768451289710,5.23775450962783,5.95476045729508,6.53483045402581,6.75639747692291;3.67500000000000,3.94385539923095,4.64772797247649,5.51776232050568,6.22163489375123,6.49049029298218;2.78866056000000,3.11251641931990,3.96038206647518,5.00840164214597,5.85626728930126,6.18012314862116;1.83750000000000,2.22020278990413,3.22213170146256,4.46058394477115,5.46251285632958,5.84521564623371;0.886340175000000,1.32777061452282,2.48345050886238,3.91194941849585,5.06762931283541,5.50905975235823;0,0.496066159229244,1.79478422476002,3.40008803736309,4.69880610289387,5.19487226212312;-0.761117490000000,-0.218216694889687,1.20311603922846,2.95997991724411,4.38131265136225,4.92421344647257;-1.34514334500000,-0.766388454001686,0.748811521787141,2.62170169136817,4.13690166715699,4.71565655815531;-1.71227731500000,-1.11106590176511,0.462926012508200,2.40848701458503,3.98247892885834,4.58369034209323;-1.83750000000000,-1.22880280549067,0.364787138591455,2.33457263773705,3.92816258181918,4.53685977632851;-1.71227731500000,-1.11156146685991,0.461133041151576,2.40509036089436,3.97778486890584,4.57850071704593;-1.34514334500000,-0.767318253164094,0.745447476814838,2.61532875310089,4.12809448307982,4.70591957491572;-0.761117490000000,-0.219575411031498,1.19820015804632,2.95066713826495,4.36844270734277,4.90998478631127;0,0.494365782488072,1.78863220391678,3.38843348179806,4.68269990322677,5.17706568571484;0.886340175000000,1.32586361718932,2.47655092769332,3.89887866432267,5.04956597482667,5.48908941701600;1.83750000000000,2.21826670451185,3.21512687870814,4.44731381807705,5.44417399227335,5.82494069678519;2.78866056000000,3.11078971701493,3.95413479884738,4.99656664848240,5.83991173031485,6.16204088732978;3.67500000000000,3.94265164788369,4.64337275918811,5.50951168602957,6.21023279733398,6.47788444521767;4.43611749000000,4.65704658185604,5.23544645343881,5.95038801289226,6.52878788447502,6.74971697633106;5.02014334500000,5.20521307975344,5.68973193562688,6.28863017786687,6.77314903374031,6.95821876849375;5.38727731500000,5.54976150236841,5.97515062753331,6.50096050312629,6.92634962829118,7.08883381565959;5.51250000000000,5.66727229990665,6.07247144157925,6.57332512511115,6.97852426678375,7.13329656669040;];
y(1:N1(komp),1:M1(komp),komp) = [3,4.73794535118798,9.28794535118798,14.9120546488120,19.4620546488120,21.2000000000000;2.99999579837536,4.73794155078278,9.28794260118895,14.9120531971864,19.4620542475926,21.2000000000000;2.99999631884266,4.73794202154989,9.28794294183922,14.9120533770034,19.4620542972928,21.2000000000000;2.99860774962653,4.73668604889496,9.28703411148833,14.9115736381382,19.4619217007316,21.2000000000000;2.99111060362369,4.72990481663074,9.28212716572482,14.9089834378989,19.4612057869930,21.2000000000000;2.97691554896254,4.71706526907168,9.27283638183105,14.9040791671315,19.4598502798909,21.2000000000000;2.96891028553637,4.70982444028049,9.26759686889640,14.9013134166400,19.4590858452559,21.2000000000000;2.96869390376826,4.70962872113260,9.26745524519053,14.9012386585777,19.4590651826357,21.2000000000000;2.97404464946373,4.71446851608044,9.27095735371451,14.9030872957492,19.4595761333833,21.2000000000000;2.98233854242454,4.72197041273826,9.27638577713212,14.9059527652924,19.4603681296863,21.2000000000000;2.99078080844386,4.72960651408825,9.28191131197728,14.9088694964666,19.4611742943556,21.2000000000000;2.99677432588772,4.73502770154427,9.28583412007233,14.9109402058154,19.4617466243435,21.2000000000000;3,4.73794535118798,9.28794535118798,14.9120546488120,19.4620546488120,21.2000000000000;2.99525872245267,4.73365682535889,9.28484214474572,14.9104165777069,19.4616018970938,21.2000000000000;2.98039537911139,4.72021280501009,9.27511396023224,14.9052814188791,19.4601825741013,21.2000000000000;2.95492293120542,4.69717275943497,9.25844202663362,14.8964809045718,19.4577501717704,21.2000000000000;2.92625070048625,4.67123848311616,9.23967580799460,14.8865748924916,19.4550122173701,21.2000000000000;2.90455187301289,4.65161170928750,9.22547374103428,14.8790781319786,19.4529401637254,21.2000000000000;2.89944608918675,4.64699348443196,9.22213196213527,14.8773141270515,19.4524526047548,21.2000000000000;2.91729853197322,4.66314117062788,9.23381653763457,14.8834819943386,19.4541573613453,21.2000000000000;2.95532076241347,4.69753260114310,9.25870241053973,14.8966183518737,19.4577881612704,21.2000000000000;2.98450344911356,4.72392858923410,9.27780272695571,14.9067007221579,19.4605748598795,21.2000000000000;2.99710254002634,4.73532457402154,9.28604893901495,14.9110536010114,19.4617779660048,21.2000000000000;2.99982852815563,4.73779025344772,9.28783312140881,14.9119954067468,19.4620382747079,21.2000000000000;3,4.73794535118798,9.28794535118798,14.9120546488120,19.4620546488120,21.2000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-2.63549640619545,-2.99023060296859,-3.42870618412398,-3.78344038089712,-3.91893678709257;-2.49541654000000,-2.63198561498950,-2.98952809512413,-3.43147490541440,-3.78901738554903,-3.92558646053853;-2.50429019500000,-2.64234185063388,-3.00376577728657,-3.45051031932419,-3.81193424597688,-3.94998590161075;-2.58342250000000,-2.71894189786377,-3.07373628760604,-3.51228627136303,-3.86708066110530,-4.00260005896907;-2.71063703500000,-2.84075233159616,-3.18139860054117,-3.60246054523888,-3.94310681418389,-4.07322211078005;-2.83895333500000,-2.96337169960541,-3.28910320696705,-3.69172949247952,-4.01746099984116,-4.14187936444657;-2.89304198500000,-3.01597450723065,-3.33781602875324,-3.73563402733712,-4.05747554885971,-4.18040807109036;-2.89439879500000,-3.01860576593666,-3.34378383748851,-3.74572603871889,-4.07090411027074,-4.19511108120740;-2.85930916000000,-2.98646255131211,-3.31935445155203,-3.73083146940766,-4.06372336964758,-4.19087676095969;-2.79664012000000,-2.92786379438038,-3.27141183403687,-3.69606056458908,-4.03960860424556,-4.17083227862594;-2.71450166500000,-2.85050923528563,-3.20658167702069,-3.64671141991957,-4.00278386165463,-4.13879143194026;-2.62695655000000,-2.76783014107197,-3.13664199061565,-3.59251850755906,-3.96133035710274,-4.10220394817471;-2.50000000000000,-2.64849026788865,-3.03724283621970,-3.51776743710452,-3.90652000543558,-4.05501027332422;-2.34610423000000,-2.50434088586561,-2.91860982918791,-3.43067440410127,-3.84494334742356,-4.00318000328918;-2.18752798000000,-2.35611543449889,-2.79748312045382,-3.34304358336588,-3.78441126932080,-3.95299872381969;-2.02739720500000,-2.20615119293990,-2.67413520899114,-3.25259526521382,-3.72057928126506,-3.89933326920496;-1.89725002000000,-2.08382676336630,-2.57229101900953,-3.17606604356340,-3.66453029920663,-3.85110704257293;-1.81579952500000,-2.00661588437780,-2.50617959883840,-3.12367430900399,-3.62323802346458,-3.81405438284238;-1.79810366500000,-1.98865078288513,-2.48750961396674,-3.10413304035969,-3.60299187144130,-3.79353898932643;-1.86229489000000,-2.04702839455300,-2.53066698833363,-3.12847716678890,-3.61211576056954,-3.79684926512254;-2.02946843500000,-2.20166060088379,-2.65246554376402,-3.20969109775690,-3.66049604063713,-3.83268820652092;-2.22207445000000,-2.37992706680492,-2.79319058281333,-3.30401238122029,-3.71727589722869,-3.87512851403361;-2.37967168000000,-2.52543433911962,-2.90704593498533,-3.37874380847754,-3.76035540434326,-3.90611806346287;-2.47071980500000,-2.60881998915018,-2.97037096510797,-3.41727254872319,-3.77882352468098,-3.91692370883116;-2.50000000000000,-2.63549640619545,-2.99023060296859,-3.42870618412398,-3.78344038089712,-3.91893678709257;];
lift(komp) = 1;

% left wingtip
komp = komp+1;
M1(komp) = 5;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [4.53685977632851,4.53685977632851,4.53685977632851,4.53685977632851,4.53685977632851;4.58369034209323,4.59265941690159,4.59484966482031,4.58898292443362,4.57850071704593;4.71565655815531,4.73248909784151,4.73659236310312,4.72557981472638,4.70591957491572;4.92421344647257,4.94881609127009,4.95480283288253,4.93870324065962,4.90998478631127;5.19487226212312,5.22566482033173,5.23314687070535,5.21299274898575,5.17706568571484;5.50905975235823,5.54359334890934,5.55197647390654,5.52937040817974,5.48908941701600;5.84521564623371,5.88027000491586,5.88877739006519,5.86582854081719,5.82494069678519;6.18012314862116,6.21137536349595,6.21896524443814,6.19850582846328,6.16204088732978;6.49049029298218,6.51226470921181,6.51756310219123,6.50331047395272,6.47788444521767;6.75639747692291,6.76793005866754,6.77074227595065,6.76319484155590,6.74971697633106;6.96051778447303,6.96448483436930,6.96545371923947,6.96285783566528,6.95821876849375;7.08928781123905,7.09007103493553,7.09026244734988,7.08974995898042,7.08883381565959;7.13329656669040,7.13329656669040,7.13329656669040,7.13329656669040,7.13329656669040;];
y(1:N1(komp),1:M1(komp),komp) = [-21.2000000000000,-21.2000000000000,-21.2000000000000,-21.2000000000000,-21.2000000000000;-21.2000000000000,-21.2350582976427,-21.2495799200000,-21.2350582976427,-21.2000000000000;-21.2000000000000,-21.2657777880760,-21.2930238400000,-21.2657777880760,-21.2000000000000;-21.2000000000000,-21.2961211259860,-21.3359358000000,-21.2961211259860,-21.2000000000000;-21.2000000000000,-21.3202915914019,-21.3701180000000,-21.3202915914019,-21.2000000000000;-21.2000000000000,-21.3349087755034,-21.3907898200000,-21.3349087755034,-21.2000000000000;-21.2000000000000,-21.3369665835158,-21.3937000000000,-21.3369665835158,-21.2000000000000;-21.2000000000000,-21.3221539692422,-21.3727518000000,-21.3221539692422,-21.2000000000000;-21.2000000000000,-21.2851582838719,-21.3204320000000,-21.2851582838719,-21.2000000000000;-21.2000000000000,-21.2451298458013,-21.2638232400000,-21.2451298458013,-21.2000000000000;-21.2000000000000,-21.2155309074841,-21.2219640200000,-21.2155309074841,-21.2000000000000;-21.2000000000000,-21.2030669483842,-21.2043373200000,-21.2030669483842,-21.2000000000000;-21.2000000000000,-21.2000000000000,-21.2000000000000,-21.2000000000000,-21.2000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [-4.05501027332422,-4.05501027332422,-4.05501027332422,-4.05501027332422,-4.05501027332422;-4.10220394817471,-4.09061294096940,-4.05680860148980,-4.02059279859918,-4.00318000328918;-4.13879143194026,-4.11701973456020,-4.05358507590946,-3.98564572105857,-3.95299872381969;-4.17083227862594,-4.13896132719356,-4.04624164744719,-3.94698525135126,-3.89933326920496;-4.19087676095969,-4.15090060331474,-4.03482869857619,-3.91065138592621,-3.85110704257293;-4.19511108120740,-4.15015867348633,-4.01993363972940,-3.88071625145842,-3.81405438284238;-4.18040807109036,-4.13464108995789,-4.00237635852321,-3.86108885707597,-3.79353898932643;-4.14187936444657,-4.10094731909429,-3.98293883860494,-3.85697858364952,-3.79684926512254;-4.07322211078005,-4.04461259605899,-3.96231290503818,-3.87453157148857,-3.83268820652092;-4.00260005896907,-3.98740466499300,-3.94377539859789,-3.89726926879871,-3.87512851403361;-3.94998590161075,-3.94474768047551,-3.92972939598133,-3.91372850536820,-3.90611806346287;-3.92558646053853,-3.92455094061075,-3.92158475493284,-3.91842545289173,-3.91692370883116;-3.91893678709257,-3.91893678709257,-3.91893678709257,-3.91893678709257,-3.91893678709257;];
lift(komp) = 0;

% right wingtip
komp = komp+1;
M1(komp) = 5;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [4.53685977632851,4.53685977632851,4.53685977632851,4.53685977632851,4.53685977632851;4.57850071704593,4.58898292443362,4.59484966482031,4.59265941690159,4.58369034209323;4.70591957491572,4.72557981472638,4.73659236310312,4.73248909784151,4.71565655815531;4.90998478631127,4.93870324065962,4.95480283288253,4.94881609127009,4.92421344647257;5.17706568571484,5.21299274898575,5.23314687070535,5.22566482033173,5.19487226212312;5.48908941701600,5.52937040817974,5.55197647390654,5.54359334890934,5.50905975235823;5.82494069678519,5.86582854081719,5.88877739006519,5.88027000491586,5.84521564623371;6.16204088732978,6.19850582846328,6.21896524443814,6.21137536349595,6.18012314862116;6.47788444521767,6.50331047395272,6.51756310219123,6.51226470921181,6.49049029298218;6.74971697633106,6.76319484155590,6.77074227595065,6.76793005866754,6.75639747692291;6.95821876849375,6.96285783566528,6.96545371923947,6.96448483436930,6.96051778447303;7.08883381565959,7.08974995898042,7.09026244734988,7.09007103493553,7.08928781123905;7.13329656669040,7.13329656669040,7.13329656669040,7.13329656669040,7.13329656669040;];
y(1:N1(komp),1:M1(komp),komp) = [21.2000000000000,21.2000000000000,21.2000000000000,21.2000000000000,21.2000000000000;21.2000000000000,21.2350582976427,21.2495799200000,21.2350582976427,21.2000000000000;21.2000000000000,21.2657777880760,21.2930238400000,21.2657777880760,21.2000000000000;21.2000000000000,21.2961211259860,21.3359358000000,21.2961211259860,21.2000000000000;21.2000000000000,21.3202915914019,21.3701180000000,21.3202915914019,21.2000000000000;21.2000000000000,21.3349087755034,21.3907898200000,21.3349087755034,21.2000000000000;21.2000000000000,21.3369665835158,21.3937000000000,21.3369665835158,21.2000000000000;21.2000000000000,21.3221539692422,21.3727518000000,21.3221539692422,21.2000000000000;21.2000000000000,21.2851582838719,21.3204320000000,21.2851582838719,21.2000000000000;21.2000000000000,21.2451298458013,21.2638232400000,21.2451298458013,21.2000000000000;21.2000000000000,21.2155309074841,21.2219640200000,21.2155309074841,21.2000000000000;21.2000000000000,21.2030669483842,21.2043373200000,21.2030669483842,21.2000000000000;21.2000000000000,21.2000000000000,21.2000000000000,21.2000000000000,21.2000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [-4.05501027332422,-4.05501027332422,-4.05501027332422,-4.05501027332422,-4.05501027332422;-4.00318000328918,-4.02059279859918,-4.05680860148980,-4.09061294096940,-4.10220394817471;-3.95299872381969,-3.98564572105857,-4.05358507590946,-4.11701973456020,-4.13879143194026;-3.89933326920496,-3.94698525135126,-4.04624164744719,-4.13896132719356,-4.17083227862594;-3.85110704257293,-3.91065138592621,-4.03482869857619,-4.15090060331474,-4.19087676095969;-3.81405438284238,-3.88071625145842,-4.01993363972940,-4.15015867348633,-4.19511108120740;-3.79353898932643,-3.86108885707597,-4.00237635852321,-4.13464108995789,-4.18040807109036;-3.79684926512254,-3.85697858364952,-3.98293883860494,-4.10094731909429,-4.14187936444657;-3.83268820652092,-3.87453157148857,-3.96231290503818,-4.04461259605899,-4.07322211078005;-3.87512851403361,-3.89726926879871,-3.94377539859789,-3.98740466499300,-4.00260005896907;-3.90611806346287,-3.91372850536820,-3.92972939598133,-3.94474768047551,-3.94998590161075;-3.91692370883116,-3.91842545289173,-3.92158475493284,-3.92455094061075,-3.92558646053853;-3.91893678709257,-3.91893678709257,-3.91893678709257,-3.91893678709257,-3.91893678709257;];
lift(komp) = 0;

% fuselage above wings
komp = komp+1;
M1(komp) = 8;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000;-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000;-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000;-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000;0,0,0,0,0,0,0,0;0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000;1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000;2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000;3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000;4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000;5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000;5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000;5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000;];
y(1:N1(komp),1:M1(komp),komp) = [-3,-2.94484419116420,-2.26776695296637,-0.500000000000000,0.500000000000000,2.26776695296637,2.94484419116419,3;-2.99525872245267,-2.91352072523590,-2.21249241969125,-0.500000000000000,0.500000000000000,2.21249241969125,2.91352072523590,2.99525872245267;-2.98039537911139,-2.87389406513651,-2.15360514482751,-0.500000000000000,0.500000000000000,2.15360514482751,2.87389406513651,2.98039537911139;-2.95492293120542,-2.82612953754441,-2.09193169019591,-0.500000000000000,0.500000000000000,2.09193169019591,2.82612953754441,2.95492293120542;-2.92625070048625,-2.78137145367609,-2.03998783274414,-0.500000000000000,0.500000000000000,2.03998783274414,2.78137145367609,2.92625070048625;-2.90455187301289,-2.75054767358550,-2.00656875257985,-0.500000000000000,0.500000000000000,2.00656875257985,2.75054767358550,2.90455187301289;-2.89944608918675,-2.74355658171972,-1.99920965220012,-0.500000000000000,0.500000000000000,1.99920965220012,2.74355658171972,2.89944608918675;-2.91729853197322,-2.76841359073281,-2.02573543332388,-0.500000000000000,0.500000000000000,2.02573543332388,2.76841359073281,2.91729853197322;-2.95532076241347,-2.82679818189903,-2.09274465742316,-0.500000000000000,0.500000000000000,2.09274465742315,2.82679818189903,2.95532076241347;-2.98450344911356,-2.88316972209545,-2.16661125116207,-0.500000000000000,0.500000000000000,2.16661125116207,2.88316972209545,2.98450344911356;-2.99710254002634,-2.92094823823330,-2.22469985794630,-0.500000000000000,0.500000000000000,2.22469985794630,2.92094823823330,2.99710254002634;-2.99982852815563,-2.93942131406045,-2.25738435074687,-0.500000000000000,0.500000000000000,2.25738435074687,2.93942131406045,2.99982852815563;-3,-2.94484419116420,-2.26776695296637,-0.500000000000000,0.500000000000000,2.26776695296637,2.94484419116419,3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-1.97775783305952,-0.732233047033633,0,0,-0.732233047033629,-1.97775783305951,-2.50000000000000;-2.34610423000000,-1.84814287696093,-0.678635206088579,0,0,-0.678635206088575,-1.84814287696093,-2.34610423000000;-2.18752798000000,-1.71601851583747,-0.625009326689864,0,0,-0.625009326689862,-1.71601851583747,-2.18752798000000;-2.02739720500000,-1.58396431588971,-0.572371017609977,0,0,-0.572371017609974,-1.58396431588971,-2.02739720500000;-1.89725002000000,-1.47757920093933,-0.530625105522060,0,0,-0.530625105522058,-1.47757920093933,-1.89725002000000;-1.81579952500000,-1.41140679364654,-0.504943461014201,0,0,-0.504943461014198,-1.41140679364654,-1.81579952500000;-1.79810366500000,-1.39707032652933,-0.499407483081576,0,0,-0.499407483081573,-1.39707032652933,-1.79810366500000;-1.86229489000000,-1.44914331073229,-0.519562829196544,0,0,-0.519562829196542,-1.44914331073229,-1.86229489000000;-2.02946843500000,-1.58566405478547,-0.573042694751647,0,0,-0.573042694751644,-1.58566405478547,-2.02946843500000;-2.22207445000000,-1.74468412191489,-0.636560455099228,0,0,-0.636560455099225,-1.74468412191489,-2.22207445000000;-2.37967168000000,-1.87629363656038,-0.690190507263266,0,0,-0.690190507263263,-1.87629363656038,-2.37967168000000;-2.47071980500000,-1.95298660664699,-0.721911069785879,0,0,-0.721911069785876,-1.95298660664699,-2.47071980500000;-2.50000000000000,-1.97775783305952,-0.732233047033633,0,0,-0.732233047033629,-1.97775783305951,-2.50000000000000;];
lift(komp) = 0;

% fuselage below wings
komp = komp+1;
M1(komp) = 8;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000;-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000,-1.71227731500000;-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000,-1.34514334500000;-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000,-0.761117490000000;0,0,0,0,0,0,0,0;0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000,0.886340175000000;1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000,1.83750000000000;2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000,2.78866056000000;3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000,3.67500000000000;4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000,4.43611749000000;5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000,5.02014334500000;5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000,5.38727731500000;5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000;];
y(1:N1(komp),1:M1(komp),komp) = [3,2.94484419116420,2.26776695296637,0.500000000000000,-0.500000000000000,-2.26776695296637,-2.94484419116419,-3;2.99677432588772,2.91950800354778,2.22229623250474,0.500000000000000,-0.500000000000000,-2.22229623250473,-2.91950800354778,-2.99677432588772;2.99078080844386,2.89926387098834,2.19022865871751,0.500000000000000,-0.500000000000000,-2.19022865871751,-2.89926387098834,-2.99078080844386;2.98233854242454,2.87818969027078,2.15957821448704,0.500000000000000,-0.500000000000000,-2.15957821448704,-2.87818969027078,-2.98233854242454;2.97404464946373,2.86073985381034,2.13580669701527,0.500000000000000,-0.500000000000000,-2.13580669701526,-2.86073985381034,-2.97404464946373;2.96869390376826,2.85044517470055,2.12234444747409,0.500000000000000,-0.500000000000000,-2.12234444747408,-2.85044517470055,-2.96869390376826;2.96891028553637,2.85085028106503,2.12286706749198,0.500000000000000,-0.500000000000000,-2.12286706749197,-2.85085028106503,-2.96891028553637;2.97691554896254,2.86653892573407,2.14356573682041,0.500000000000000,-0.500000000000000,-2.14356573682040,-2.86653892573407,-2.97691554896254;2.99111060362369,2.90020561862477,2.19165708884809,0.500000000000000,-0.500000000000000,-2.19165708884809,-2.90020561862477,-2.99111060362369;2.99860774962653,2.92873035245070,2.23802240348046,0.500000000000000,-0.500000000000000,-2.23802240348046,-2.92873035245070,-2.99860774962653;2.99999631884266,2.94406535196282,2.26624948867650,0.500000000000000,-0.500000000000000,-2.26624948867650,-2.94406535196282,-2.99999631884266;2.99999579837536,2.94567030330317,2.26938670872142,0.500000000000000,-0.500000000000000,-2.26938670872141,-2.94567030330317,-2.99999579837536;3,2.94484419116420,2.26776695296637,0.500000000000000,-0.500000000000000,-2.26776695296637,-2.94484419116419,-3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-3.02224216694048,-4.26776695296637,-5,-5,-4.26776695296637,-3.02224216694049,-2.50000000000000;-2.62695655000000,-3.12927022873184,-4.31209704141362,-5,-5,-4.31209704141362,-3.12927022873184,-2.62695655000000;-2.71450166500000,-3.20251895160917,-4.34204426690837,-5,-5,-4.34204426690837,-3.20251895160917,-2.71450166500000;-2.79664012000000,-3.27085264291547,-4.36970589933283,-5,-5,-4.36970589933284,-3.27085264291547,-2.79664012000000;-2.85930916000000,-3.32274378917835,-4.39053866662388,-5,-5,-4.39053866662388,-3.32274378917835,-2.85930916000000;-2.89439879500000,-3.35170856560616,-4.40210370215454,-5,-5,-4.40210370215454,-3.35170856560616,-2.89439879500000;-2.89304198500000,-3.35058976952259,-4.40165782443898,-5,-5,-4.40165782443898,-3.35058976952259,-2.89304198500000;-2.83895333500000,-3.30591160370441,-4.38379714108234,-5,-5,-4.38379714108234,-3.30591160370441,-2.83895333500000;-2.71063703500000,-3.19929463627436,-4.34073254269869,-5,-5,-4.34073254269870,-3.19929463627437,-2.71063703500000;-2.58342250000000,-3.09267940329044,-4.29701923334170,-5,-5,-4.29701923334170,-3.09267940329044,-2.58342250000000;-2.50429019500000,-3.02587503775598,-4.26928311577034,-5,-5,-4.26928311577034,-3.02587503775598,-2.50429019500000;-2.49541654000000,-3.01835968934800,-4.26614571171237,-5,-5,-4.26614571171237,-3.01835968934801,-2.49541654000000;-2.50000000000000,-3.02224216694048,-4.26776695296637,-5,-5,-4.26776695296637,-3.02224216694049,-2.50000000000000;];
lift(komp) = 0;

% upper front fuselage part
komp = komp+1;
M1(komp) = 8;
N1(komp) = 9;
x(1:N1(komp),1:M1(komp),komp) = [-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000;-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793;-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520;-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275;-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000;-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725;-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480;-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207;-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000;];
y(1:N1(komp),1:M1(komp),komp) = [-3,-2.66506350946110,-1.75000000000000,-0.500000000000000,0.500000000000000,1.75000000000000,2.66506350946110,3;-3,-2.67980767724818,-1.77151059958910,-0.500000000000000,0.500000000000000,1.77151059958909,2.67980767724818,3;-3,-2.72009215259780,-1.83206881318465,-0.500000000000000,0.500000000000000,1.83206881318465,2.72009215259780,3;-3,-2.77559090222436,-1.92068213641310,-0.500000000000000,0.500000000000000,1.92068213641310,2.77559090222436,3;-3,-2.83349954316815,-2.02190357252180,-0.500000000000000,0.500000000000000,2.02190357252180,2.83349954316815,3;-3,-2.88303274837045,-2.11930685936724,-0.500000000000000,0.500000000000000,2.11930685936724,2.88303274837045,3;-3,-2.91833205756346,-2.19870893484869,-0.500000000000000,0.500000000000000,2.19870893484868,2.91833205756346,3;-3,-2.93844627579776,-2.25006520166868,-0.500000000000000,0.500000000000000,2.25006520166868,2.93844627579776,3;-3,-2.94484419116420,-2.26776695296637,-0.500000000000000,0.500000000000000,2.26776695296637,2.94484419116419,3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-1.25000000000000,-0.334936490538904,0,0,-0.334936490538903,-1.25000000000000,-2.50000000000000;-2.50000000000000,-1.27589277830335,-0.347498944220333,0,0,-0.347498944220333,-1.27589277830335,-2.50000000000000;-2.50000000000000,-1.35056934355584,-0.384440339545860,0,0,-0.384440339545860,-1.35056934355584,-2.50000000000000;-2.50000000000000,-1.46477729656189,-0.442899548569223,0,0,-0.442899548569222,-1.46477729656189,-2.50000000000000;-2.50000000000000,-1.60290475308692,-0.516616649271913,0,0,-0.516616649271911,-1.60290475308692,-2.50000000000000;-2.50000000000000,-1.74425207893505,-0.595309658971780,0,0,-0.595309658971778,-1.74425207893505,-2.50000000000000;-2.50000000000000,-1.86622554535476,-0.665773199774565,0,0,-0.665773199774562,-1.86622554535476,-2.50000000000000;-2.50000000000000,-1.94865640472749,-0.714706805617535,0,0,-0.714706805617532,-1.94865640472748,-2.50000000000000;-2.50000000000000,-1.97775783305952,-0.732233047033633,0,0,-0.732233047033629,-1.97775783305951,-2.50000000000000;];
lift(komp) = 0;

% lower front fuselage part
komp = komp+1;
M1(komp) = 8;
N1(komp) = 9;
x(1:N1(komp),1:M1(komp),komp) = [-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000;-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793,-8.78150268765793;-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520,-7.99908853834520;-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275,-6.82812301369275;-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000,-5.44687500000000;-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725,-4.06562698630725;-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480,-2.89466146165480;-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207,-2.11224731234207;-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000,-1.83750000000000;];
y(1:N1(komp),1:M1(komp),komp) = [3,2.66506350946110,1.75000000000000,0.500000000000000,-0.500000000000000,-1.75000000000000,-2.66506350946110,-3;3,2.67980767724818,1.77151059958910,0.500000000000000,-0.500000000000000,-1.77151059958909,-2.67980767724818,-3;3,2.72009215259780,1.83206881318465,0.500000000000000,-0.500000000000000,-1.83206881318465,-2.72009215259780,-3;3,2.77559090222436,1.92068213641310,0.500000000000000,-0.500000000000000,-1.92068213641310,-2.77559090222436,-3;3,2.83349954316815,2.02190357252180,0.500000000000000,-0.500000000000000,-2.02190357252180,-2.83349954316815,-3;3,2.88303274837045,2.11930685936724,0.500000000000000,-0.500000000000000,-2.11930685936724,-2.88303274837045,-3;3,2.91833205756346,2.19870893484869,0.500000000000000,-0.500000000000000,-2.19870893484868,-2.91833205756346,-3;3,2.93844627579776,2.25006520166868,0.500000000000000,-0.500000000000000,-2.25006520166868,-2.93844627579776,-3;3,2.94484419116420,2.26776695296637,0.500000000000000,-0.500000000000000,-2.26776695296637,-2.94484419116419,-3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-3.75000000000000,-4.66506350946110,-5,-5,-4.66506350946110,-3.75000000000000,-2.50000000000000;-2.50000000000000,-3.72410722169665,-4.65250105577967,-5,-5,-4.65250105577967,-3.72410722169665,-2.50000000000000;-2.50000000000000,-3.64943065644416,-4.61555966045414,-5,-5,-4.61555966045414,-3.64943065644416,-2.50000000000000;-2.50000000000000,-3.53522270343811,-4.55710045143078,-5,-5,-4.55710045143078,-3.53522270343811,-2.50000000000000;-2.50000000000000,-3.39709524691308,-4.48338335072809,-5,-5,-4.48338335072809,-3.39709524691308,-2.50000000000000;-2.50000000000000,-3.25574792106495,-4.40469034102822,-5,-5,-4.40469034102822,-3.25574792106495,-2.50000000000000;-2.50000000000000,-3.13377445464524,-4.33422680022544,-5,-5,-4.33422680022544,-3.13377445464524,-2.50000000000000;-2.50000000000000,-3.05134359527251,-4.28529319438247,-5,-5,-4.28529319438247,-3.05134359527252,-2.50000000000000;-2.50000000000000,-3.02224216694048,-4.26776695296637,-5,-5,-4.26776695296637,-3.02224216694049,-2.50000000000000;];
lift(komp) = 0;

% nose
komp = komp+1;
M1(komp) = 15;
N1(komp) = 6;
x(1:N1(komp),1:M1(komp),komp) = [-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000,-15.2962500000000;-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498,-14.7003830224498;-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498,-13.1403830224498;-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502,-11.2121169775502;-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017,-9.65211697755017;-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000,-9.05625000000000;];
y(1:N1(komp),1:M1(komp),komp) = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0.0477457514062632,0.580815251031514,0.971049208722517,1.11388475065677,0.971049208722517,0.580815251031515,1.30564371287829e-16,-0.580815251031514,-0.971049208722516,-1.11388475065677,-0.971049208722517,-0.580815251031515,-0.0477457514062635,0;0,0.172745751406263,1.11781405838647,1.80965207571908,2.06288236536667,1.80965207571908,1.11781405838647,2.31474975423783e-16,-1.11781405838647,-1.80965207571908,-2.06288236536667,-1.80965207571908,-1.11781405838647,-0.172745751406264,0;0,0.327254248593737,1.50028159634369,2.35899721356442,2.67330894409364,2.35899721356442,1.50028159634369,2.87308837346857e-16,-1.50028159634369,-2.35899721356442,-2.67330894409364,-2.35899721356442,-1.50028159634369,-0.327254248593737,0;0,0.452254248593737,1.69654205498805,2.60742394850711,2.94082986138236,2.60742394850711,1.69654205498805,3.04762615863775e-16,-1.69654205498805,-2.60742394850711,-2.94082986138236,-2.60742394850711,-1.69654205498805,-0.452254248593737,0;0,0.500000000000000,1.75000000000000,2.66506350946110,3,2.66506350946110,1.75000000000000,3.06161699786838e-16,-1.75000000000000,-2.66506350946110,-3,-2.66506350946110,-1.75000000000000,-0.500000000000001,0;];
z(1:N1(komp),1:M1(komp),komp) = [-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000,-3.12500000000000;-1.79232625093687,-1.79232625093687,-1.93516179287112,-2.32539575056212,-2.85846525018737,-3.39153474981263,-3.78176870750363,-3.92460424943788,-3.78176870750363,-3.39153474981263,-2.85846525018737,-2.32539575056212,-1.93516179287112,-1.79232625093687,-1.79232625093687;-0.762329232549489,-0.762329232549489,-1.01555952219708,-1.70739753952969,-2.65246584650990,-3.59753415349010,-4.28937217082271,-4.54260246047031,-4.28937217082271,-3.59753415349010,-2.65246584650990,-1.70739753952970,-1.01555952219708,-0.762329232549489,-0.762329232549489;-0.192431630625123,-0.192431630625123,-0.506743361154344,-1.36545897837507,-2.53848632612502,-3.71151367387498,-4.57022929109571,-4.88454102162493,-4.57022929109571,-3.71151367387498,-2.53848632612502,-1.36545897837508,-0.506743361154344,-0.192431630625123,-0.192431630625123;-0.0142804840142180,-0.0142804840142180,-0.347686396889467,-1.25856829040853,-2.50285609680284,-3.74714390319716,-4.65802579671622,-4.99143170959147,-4.65802579671622,-3.74714390319716,-2.50285609680284,-1.25856829040853,-0.347686396889468,-0.0142804840142180,-0.0142804840142180;0,0,-0.334936490538903,-1.25000000000000,-2.50000000000000,-3.75000000000000,-4.66506350946110,-5,-4.66506350946110,-3.75000000000000,-2.50000000000000,-1.25000000000000,-0.334936490538904,0,0;];
lift(komp) = 0;

% upper rear fuselage part
komp = komp+1;
M1(komp) = 8;
N1(komp) = 9;
x(1:N1(komp),1:M1(komp),komp) = [5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000;5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148;6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982;7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033;8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000;9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967;10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102;11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985;11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000;];
y(1:N1(komp),1:M1(komp),komp) = [-3,-2.94484419116420,-2.26776695296637,-0.500000000000000,0.500000000000000,2.26776695296637,2.94484419116419,3;-3,-2.93844627579776,-2.25006520166868,-0.500000000000000,0.500000000000000,2.25006520166868,2.93844627579776,3;-3,-2.91833205756346,-2.19870893484869,-0.500000000000000,0.500000000000000,2.19870893484868,2.91833205756346,3;-3,-2.88303274837045,-2.11930685936724,-0.500000000000000,0.500000000000000,2.11930685936724,2.88303274837045,3;-3,-2.83349954316815,-2.02190357252180,-0.500000000000000,0.500000000000000,2.02190357252180,2.83349954316815,3;-3,-2.77559090222436,-1.92068213641310,-0.500000000000000,0.500000000000000,1.92068213641310,2.77559090222436,3;-3,-2.72009215259780,-1.83206881318465,-0.500000000000000,0.500000000000000,1.83206881318465,2.72009215259780,3;-3,-2.67980767724818,-1.77151059958910,-0.500000000000000,0.500000000000000,1.77151059958909,2.67980767724818,3;-3,-2.66506350946110,-1.75000000000000,-0.500000000000000,0.500000000000000,1.75000000000000,2.66506350946110,3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-1.97775783305952,-0.732233047033633,0,0,-0.732233047033629,-1.97775783305951,-2.50000000000000;-2.50000000000000,-1.94865640472749,-0.714706805617535,0,0,-0.714706805617532,-1.94865640472748,-2.50000000000000;-2.50000000000000,-1.86622554535476,-0.665773199774565,0,0,-0.665773199774562,-1.86622554535476,-2.50000000000000;-2.50000000000000,-1.74425207893505,-0.595309658971780,0,0,-0.595309658971778,-1.74425207893505,-2.50000000000000;-2.50000000000000,-1.60290475308692,-0.516616649271913,0,0,-0.516616649271911,-1.60290475308692,-2.50000000000000;-2.50000000000000,-1.46477729656189,-0.442899548569223,0,0,-0.442899548569222,-1.46477729656189,-2.50000000000000;-2.50000000000000,-1.35056934355584,-0.384440339545860,0,0,-0.384440339545860,-1.35056934355584,-2.50000000000000;-2.50000000000000,-1.27589277830335,-0.347498944220333,0,0,-0.347498944220333,-1.27589277830335,-2.50000000000000;-2.50000000000000,-1.25000000000000,-0.334936490538904,0,0,-0.334936490538903,-1.25000000000000,-2.50000000000000;];
lift(komp) = 0;

% lower rear fuselage part
komp = komp+1;
M1(komp) = 8;
N1(komp) = 9;
x(1:N1(komp),1:M1(komp),komp) = [5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000,5.51250000000000;5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148,5.74490530230148;6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982,6.40673960868982;7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033,7.39724464556033;8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000,8.56562500000000;9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967,9.73400535443967;10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102,10.7245103913102;11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985,11.3863446976985;11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000;];
y(1:N1(komp),1:M1(komp),komp) = [3,2.94484419116420,2.26776695296637,0.500000000000000,-0.500000000000000,-2.26776695296637,-2.94484419116419,-3;3,2.93844627579776,2.25006520166868,0.500000000000000,-0.500000000000000,-2.25006520166868,-2.93844627579776,-3;3,2.91833205756346,2.19870893484869,0.500000000000000,-0.500000000000000,-2.19870893484868,-2.91833205756346,-3;3,2.88303274837045,2.11930685936724,0.500000000000000,-0.500000000000000,-2.11930685936724,-2.88303274837045,-3;3,2.83349954316815,2.02190357252180,0.500000000000000,-0.500000000000000,-2.02190357252180,-2.83349954316815,-3;3,2.77559090222436,1.92068213641310,0.500000000000000,-0.500000000000000,-1.92068213641310,-2.77559090222436,-3;3,2.72009215259780,1.83206881318465,0.500000000000000,-0.500000000000000,-1.83206881318465,-2.72009215259780,-3;3,2.67980767724818,1.77151059958910,0.500000000000000,-0.500000000000000,-1.77151059958909,-2.67980767724818,-3;3,2.66506350946110,1.75000000000000,0.500000000000000,-0.500000000000000,-1.75000000000000,-2.66506350946110,-3;];
z(1:N1(komp),1:M1(komp),komp) = [-2.50000000000000,-3.02224216694048,-4.26776695296637,-5,-5,-4.26776695296637,-3.02224216694049,-2.50000000000000;-2.50000000000000,-3.05134359527251,-4.28529319438247,-5,-5,-4.28529319438247,-3.05134359527252,-2.50000000000000;-2.50000000000000,-3.13377445464524,-4.33422680022544,-5,-5,-4.33422680022544,-3.13377445464524,-2.50000000000000;-2.50000000000000,-3.25574792106495,-4.40469034102822,-5,-5,-4.40469034102822,-3.25574792106495,-2.50000000000000;-2.50000000000000,-3.39709524691308,-4.48338335072809,-5,-5,-4.48338335072809,-3.39709524691308,-2.50000000000000;-2.50000000000000,-3.53522270343811,-4.55710045143078,-5,-5,-4.55710045143078,-3.53522270343811,-2.50000000000000;-2.50000000000000,-3.64943065644416,-4.61555966045414,-5,-5,-4.61555966045414,-3.64943065644416,-2.50000000000000;-2.50000000000000,-3.72410722169665,-4.65250105577967,-5,-5,-4.65250105577967,-3.72410722169665,-2.50000000000000;-2.50000000000000,-3.75000000000000,-4.66506350946110,-5,-5,-4.66506350946110,-3.75000000000000,-2.50000000000000;];
lift(komp) = 0;

% tail fuselage
komp = komp+1;
M1(komp) = 16;
N1(komp) = 21;
x(1:N1(komp),1:M1(komp),komp) = [11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000,11.6187500000000;12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376,12.1191254747376;13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376,13.4291254747376;15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624,15.0483745252624;16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624,16.3583745252624;16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000,16.8587500000000;16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000,16.9720467150000;17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000,17.3042155450000;17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000,17.8326198900000;18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000,18.5212500000000;19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000,19.3231768250000;20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000,20.1837500000000;21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000,21.0443238400000;21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000,21.8462500000000;22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000,22.5348801100000;23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000,23.0632844550000;23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000,23.3954532850000;23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000,23.5087500000000;23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000,23.8187500000000;24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000,24.1287500000000;24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000,24.4387500000000;];
y(1:N1(komp),1:M1(komp),komp) = [0,0.500000000000000,1.75000000000000,2.66506350946110,3,2.66506350946110,1.75000000000000,0.500000000000000,-0.500000000000000,-1.75000000000000,-2.66506350946110,-3,-2.66506350946110,-1.75000000000000,-0.500000000000000,0;0,0.500000000000000,1.74904750765573,2.66341374432700,2.99809501531146,2.66341374432700,1.74904750765573,0.500000000000000,-0.500000000000000,-1.74904750765573,-2.66341374432700,-2.99809501531146,-2.66341374432700,-1.74904750765573,-0.500000000000000,0;0,0.500000000000000,1.73747370045026,2.64336732221011,2.97494740090051,2.64336732221011,1.73747370045026,0.500000000000000,-0.500000000000000,-1.73747370045026,-2.64336732221011,-2.97494740090051,-2.64336732221011,-1.73747370045026,-0.500000000000000,0;0,0.500000000000000,1.70443989390816,2.58615109091179,2.90887978781631,2.58615109091180,1.70443989390816,0.500000000000000,-0.500000000000000,-1.70443989390816,-2.58615109091180,-2.90887978781631,-2.58615109091179,-1.70443989390816,-0.500000000000000,0;0,0.500000000000000,1.66143623532829,2.51166656934012,2.82287247065658,2.51166656934012,1.66143623532829,0.500000000000000,-0.500000000000000,-1.66143623532829,-2.51166656934012,-2.82287247065658,-2.51166656934012,-1.66143623532829,-0.500000000000000,0;0,0.500000000000000,1.64081563244998,2.47595063747218,2.78163126489996,2.47595063747218,1.64081563244998,0.500000000000000,-0.500000000000000,-1.64081563244998,-2.47595063747218,-2.78163126489996,-2.47595063747218,-1.64081563244998,-0.500000000000000,0;0.102814985000000,0.500000000000000,1.63580373698831,2.46726977989035,2.77160747397662,2.46726977989035,1.63580373698831,0.500000000000000,-0.500000000000000,-1.63580373698831,-2.46726977989035,-2.77160747397662,-2.46726977989035,-1.63580373698831,-0.500000000000000,-0.102814985000000;0.191231390000000,0.500000000000000,1.62035282928466,2.44050802272457,2.74070565856931,2.44050802272457,1.62035282928466,0.500000000000000,-0.500000000000000,-1.62035282928466,-2.44050802272457,-2.74070565856931,-2.44050802272457,-1.62035282928466,-0.500000000000000,-0.191231390000000;0.278503330000000,0.500000000000000,1.59334971850891,2.39373726289857,2.68669943701783,2.39373726289857,1.59334971850892,0.500000000000000,-0.500000000000000,-1.59334971850892,-2.39373726289857,-2.68669943701783,-2.39373726289857,-1.59334971850891,-0.500000000000000,-0.278503330000000;0.348327000000000,0.500000000000000,1.55334855420217,2.32445321395738,2.60669710840434,2.32445321395738,1.55334855420217,0.500000000000000,-0.500000000000000,-1.55334855420217,-2.32445321395738,-2.60669710840434,-2.32445321395738,-1.55334855420217,-0.500000000000000,-0.348327000000000;0.390577775000000,0.500000000000000,1.49909010405193,2.23047482155722,2.49818020810386,2.23047482155722,1.49909010405193,0.500000000000000,-0.500000000000000,-1.49909010405193,-2.23047482155722,-2.49818020810386,-2.23047482155722,-1.49909010405193,-0.500000000000000,-0.390577775000000;0.396672500000000,0.500000000000000,1.43009304604732,2.11096841152045,2.36018609209463,2.11096841152045,1.43009304604732,0.500000000000000,-0.500000000000000,-1.43009304604732,-2.11096841152045,-2.36018609209463,-2.11096841152045,-1.43009304604732,-0.500000000000000,-0.396672500000000;0.355663945000000,0.500000000000000,1.34728004342663,1.96753208345409,2.19456008685326,1.96753208345409,1.34728004342663,0.500000000000000,-0.500000000000000,-1.34728004342663,-1.96753208345409,-2.19456008685326,-1.96753208345409,-1.34728004342663,-0.500000000000000,-0.355663945000000;0.250505500000000,0.500000000000000,1.25369091824141,1.80543096359736,2.00738183648281,1.80543096359736,1.25369091824141,0.500000000000000,-0.500000000000000,-1.25369091824141,-1.80543096359736,-2.00738183648281,-1.80543096359736,-1.25369091824141,-0.500000000000000,-0.250505500000000;0.134457015000000,0.500000000000000,1.15545907011127,1.63528841171457,1.81091814022253,1.63528841171457,1.15545907011127,0.500000000000000,-0.500000000000000,-1.15545907011127,-1.63528841171457,-1.81091814022253,-1.63528841171457,-1.15545907011127,-0.500000000000000,-0.134457015000000;0.0468578950000000,0.500000000000000,1.06329101955170,1.47564866531081,1.62658203910339,1.47564866531081,1.06329101955170,0.500000000000000,-0.500000000000000,-1.06329101955170,-1.47564866531081,-1.62658203910339,-1.47564866531081,-1.06329101955170,-0.500000000000000,-0.0468578950000000;0.00934125500000000,0.500000000000000,0.993928810395544,1.35550979492714,1.48785762079109,1.35550979492714,0.993928810395544,0.500000000000000,-0.500000000000000,-0.993928810395544,-1.35550979492714,-1.48785762079109,-1.35550979492714,-0.993928810395544,-0.500000000000000,-0.00934125500000000;0,0.500000000000000,0.967411975073165,1.30958128889284,1.43482395014633,1.30958128889284,0.967411975073166,0.500000000000000,-0.500000000000000,-0.967411975073166,-1.30958128889284,-1.43482395014633,-1.30958128889284,-0.967411975073165,-0.500000000000000,0;0,0.500000000000000,0.884026757385561,1.16515385525772,1.26805351477112,1.16515385525772,0.884026757385561,0.500000000000000,-0.500000000000000,-0.884026757385561,-1.16515385525772,-1.26805351477112,-1.16515385525772,-0.884026757385561,-0.500000000000000,0;0,0.500000000000000,0.773224996856932,0.973239576454052,1.04644999371386,0.973239576454052,0.773224996856932,0.500000000000000,-0.500000000000000,-0.773224996856932,-0.973239576454052,-1.04644999371386,-0.973239576454052,-0.773224996856932,-0.500000000000000,0;0,0.500000000000000,0.500000021073424,0.500000036500242,0.500000042146849,0.500000036500242,0.500000021073424,0.500000000000000,-0.500000000000000,-0.500000021073424,-0.500000036500242,-0.500000042146849,-0.500000036500242,-0.500000021073424,-0.500000000000000,0;];
z(1:N1(komp),1:M1(komp),komp) = [0,0,-0.334936490538903,-1.25000000000000,-2.50000000000000,-3.75000000000000,-4.66506350946110,-5,-5,-4.66506350946110,-3.75000000000000,-2.50000000000000,-1.25000000000000,-0.334936490538903,0,0;0,0,-0.334681270984459,-1.24904750765573,-2.49809501531146,-3.74714252296719,-4.66150875963846,-4.99619003062292,-4.99619003062292,-4.66150875963846,-3.74714252296719,-2.49809501531146,-1.24904750765573,-0.334681270984459,0,0;0,0,-0.331580078690399,-1.23747370045026,-2.47494740090051,-3.71242110135077,-4.61831472311063,-4.94989480180103,-4.94989480180103,-4.61831472311063,-3.71242110135077,-2.47494740090051,-1.23747370045026,-0.331580078690399,0,0;0,0,-0.322728696904517,-1.20443989390816,-2.40887978781631,-3.61331968172447,-4.49503087872811,-4.81775957563263,-4.81775957563263,-4.49503087872811,-3.61331968172447,-2.40887978781631,-1.20443989390816,-0.322728696904517,0,0;0,0,-0.311205901316459,-1.16143623532829,-2.32287247065658,-3.48430870598487,-4.33453903999670,-4.64574494131316,-4.64574494131316,-4.33453903999670,-3.48430870598487,-2.32287247065658,-1.16143623532829,-0.311205901316459,0,0;0,0,-0.305680627427772,-1.14081563244998,-2.28163126489996,-3.42244689734993,-4.25758190237214,-4.56326252979991,-4.56326252979991,-4.25758190237214,-3.42244689734993,-2.28163126489996,-1.14081563244998,-0.305680627427772,0,0;0,0,-0.304337694086269,-1.13580373698831,-2.27160747397662,-3.40741121096493,-4.23887725386697,-4.54321494795324,-4.54321494795324,-4.23887725386697,-3.40741121096493,-2.27160747397662,-1.13580373698831,-0.304337694086269,0,0;0,0,-0.300197635844747,-1.12035282928466,-2.24070565856931,-3.36105848785397,-4.18121368129388,-4.48141131713863,-4.48141131713863,-4.18121368129388,-3.36105848785397,-2.24070565856931,-1.12035282928466,-0.300197635844747,0,0;0,0,-0.292962174119259,-1.09334971850891,-2.18669943701783,-3.28004915552674,-4.08043669991640,-4.37339887403566,-4.37339887403566,-4.08043669991640,-3.28004915552674,-2.18669943701783,-1.09334971850891,-0.292962174119259,0,0;0,0,-0.282243894446962,-1.05334855420217,-2.10669710840434,-3.16004566260651,-3.93115032236171,-4.21339421680868,-4.21339421680868,-3.93115032236171,-3.16004566260651,-2.10669710840434,-1.05334855420217,-0.282243894446962,0,0;0,0,-0.267705386546641,-0.999090104051932,-1.99818020810386,-2.99727031215579,-3.72865502966108,-3.99636041620773,-3.99636041620773,-3.72865502966108,-2.99727031215579,-1.99818020810386,-0.999090104051932,-0.267705386546641,0,0;0,0,-0.249217680574182,-0.930093046047317,-1.86018609209463,-2.79027913814195,-3.47115450361509,-3.72037218418927,-3.72037218418927,-3.47115450361509,-2.79027913814195,-1.86018609209463,-0.930093046047317,-0.249217680574182,0,0;0,0,-0.227028003399173,-0.847280043426632,-1.69456008685326,-2.54184013027990,-3.16209217030736,-3.38912017370653,-3.38912017370653,-3.16209217030736,-2.54184013027990,-1.69456008685326,-0.847280043426632,-0.227028003399173,0,0;0,0,-0.201950872885456,-0.753690918241407,-1.50738183648281,-2.26107275472422,-2.81281280008017,-3.01476367296563,-3.01476367296563,-2.81281280008017,-2.26107275472422,-1.50738183648281,-0.753690918241407,-0.201950872885456,0,0;0,0,-0.175629728507969,-0.655459070111267,-1.31091814022253,-1.96637721033380,-2.44620655193710,-2.62183628044507,-2.62183628044507,-2.44620655193710,-1.96637721033380,-1.31091814022253,-0.655459070111267,-0.175629728507969,0,0;0,0,-0.150933373792580,-0.563291019551695,-1.12658203910339,-1.68987305865509,-2.10223070441420,-2.25316407820678,-2.25316407820678,-2.10223070441420,-1.68987305865509,-1.12658203910339,-0.563291019551695,-0.150933373792580,0,0;0,0,-0.132347825863951,-0.493928810395544,-0.987857620791088,-1.48178643118663,-1.84336741571823,-1.97571524158218,-1.97571524158218,-1.84336741571823,-1.48178643118663,-0.987857620791088,-0.493928810395544,-0.132347825863951,0,0;0,0,-0.125242661253491,-0.467411975073165,-0.934823950146331,-1.40223592521950,-1.74440523903917,-1.86964790029266,-1.86964790029266,-1.74440523903917,-1.40223592521950,-0.934823950146331,-0.467411975073165,-0.125242661253491,0,0;0,0,-0.102899659513404,-0.384026757385561,-0.768053514771122,-1.15208027215668,-1.43320737002884,-1.53610702954224,-1.53610702954224,-1.43320737002884,-1.15208027215668,-0.768053514771122,-0.384026757385561,-0.102899659513404,0,0;0,0,-0.0732104172598108,-0.273224996856932,-0.546449993713863,-0.819674990570795,-1.01968957016792,-1.09289998742773,-1.09289998742773,-1.01968957016792,-0.819674990570795,-0.546449993713863,-0.273224996856932,-0.0732104172598108,0,0;0,0,-5.64660701100546e-09,-2.10734242554470e-08,-4.21468485108940e-08,-6.32202727663411e-08,-7.86470900107826e-08,-8.42936970217881e-08,-8.42936970217881e-08,-7.86470900107826e-08,-6.32202727663411e-08,-4.21468485108940e-08,-2.10734242554470e-08,-5.64660701100546e-09,0,0;];
lift(komp) = 0;

% vertical stabilizer
komp = komp+1;
M1(komp) = 6;
N1(komp) = 25;
x(1:N1(komp),1:M1(komp),komp) = [23.5087500000000,23.8448800899001,24.7248800899001,25.8126199100999,26.6926199100999,27.0287500000000;23.3954532850000,23.7337959565644,24.6195885705644,25.7144884554356,26.6002810694356,26.9386237410000;23.0632844550000,23.4081140813071,24.3108897633071,25.4267818746929,26.3295575566929,26.6743871830000;22.5348801100000,22.8900289919456,23.8198208359456,24.9691067600544,25.8988986040544,26.2540474860000;21.8462500000000,22.2148472008564,23.1798472008564,24.3726527991437,25.3376527991437,25.7062500000000;21.0443238400000,21.4285819284446,22.4345826644446,23.6780679595554,24.6840686955554,25.0683267840000;20.1837500000000,20.5848143118126,21.6348143118126,22.9326856881874,23.9826856881874,24.3837500000000;19.3231768250000,19.7410473471938,20.8350465771938,22.1873039928062,23.2813032228062,23.6991737450000;18.5212500000000,18.9547814227689,20.0897814227689,21.4927185772311,22.6277185772311,23.0612500000000;17.8326198900000,18.2795996316797,19.4498077876797,20.8962646163203,22.0664727723203,22.5134525140000;17.3042155450000,17.7615145423181,18.9587388603181,20.4385895016819,21.6358138196819,22.0931128170000;16.9720467150000,17.4358326670608,18.6500400530608,20.1508829209392,21.3650903069392,21.8288762590000;16.8587500000000,17.3247485337251,18.5447485337251,20.0527514662749,21.2727514662749,21.7387500000000;16.9720467150000,17.4358326670608,18.6500400530608,20.1508829209392,21.3650903069392,21.8288762590000;17.3042155450000,17.7615145423181,18.9587388603181,20.4385895016819,21.6358138196819,22.0931128170000;17.8326198900000,18.2795996316797,19.4498077876797,20.8962646163203,22.0664727723203,22.5134525140000;18.5212500000000,18.9547814227689,20.0897814227689,21.4927185772311,22.6277185772311,23.0612500000000;19.3231768250000,19.7410473471938,20.8350465771938,22.1873039928062,23.2813032228062,23.6991737450000;20.1837500000000,20.5848143118126,21.6348143118126,22.9326856881874,23.9826856881874,24.3837500000000;21.0443238400000,21.4285819284446,22.4345826644446,23.6780679595554,24.6840686955554,25.0683267840000;21.8462500000000,22.2148472008564,23.1798472008564,24.3726527991437,25.3376527991437,25.7062500000000;22.5348801100000,22.8900289919456,23.8198208359456,24.9691067600544,25.8988986040544,26.2540474860000;23.0632844550000,23.4081140813071,24.3108897633071,25.4267818746929,26.3295575566929,26.6743871830000;23.3954532850000,23.7337959565644,24.6195885705644,25.7144884554356,26.6002810694356,26.9386237410000;23.5087500000000,23.8448800899001,24.7248800899001,25.8126199100999,26.6926199100999,27.0287500000000;];
y(1:N1(komp),1:M1(komp),komp) = [0,0,0,0,0,0;0.00934125500000000,0.00915882879695897,0.00868123079695897,0.00809088720304103,0.00761328920304103,0.00743086300000000;0.0468578950000000,0.0459428029842757,0.0435470609842757,0.0405857610157244,0.0381900190157244,0.0372749270000000;0.134457015000000,0.131831191947457,0.124956697947457,0.116459356052543,0.109584862052543,0.106959039000000;0.250505500000000,0.245613355721111,0.232805555721111,0.216974244278889,0.204166444278889,0.199274300000000;0.355663945000000,0.348718152058372,0.330533830058372,0.308056771941628,0.289872449941628,0.282926657000000;0.396672500000000,0.388925847325837,0.368644847325837,0.343576152674163,0.323295152674163,0.315548500000000;0.390577775000000,0.382950146754602,0.362980756754602,0.338297233245398,0.318327843245398,0.310700215000000;0.348327000000000,0.341524490912445,0.323715290912445,0.301701909087555,0.283892709087555,0.277090200000000;0.278503330000000,0.273064413598919,0.258825145598919,0.241224442401081,0.226985174401081,0.221546258000000;0.191231390000000,0.187496815108301,0.177719571108301,0.165634232891699,0.155856988891699,0.152122414000000;0.102814985000000,0.100807101976866,0.0955503959768655,0.0890527500231345,0.0837960440231345,0.0817881610000000;0,0,0,0,0,0;-0.102814985000000,-0.100807101976866,-0.0955503959768655,-0.0890527500231345,-0.0837960440231345,-0.0817881610000000;-0.191231390000000,-0.187496815108301,-0.177719571108301,-0.165634232891699,-0.155856988891699,-0.152122414000000;-0.278503330000000,-0.273064413598919,-0.258825145598919,-0.241224442401081,-0.226985174401081,-0.221546258000000;-0.348327000000000,-0.341524490912445,-0.323715290912445,-0.301701909087555,-0.283892709087555,-0.277090200000000;-0.390577775000000,-0.382950146754602,-0.362980756754602,-0.338297233245398,-0.318327843245398,-0.310700215000000;-0.396672500000000,-0.388925847325837,-0.368644847325837,-0.343576152674163,-0.323295152674163,-0.315548500000000;-0.355663945000000,-0.348718152058372,-0.330533830058372,-0.308056771941628,-0.289872449941628,-0.282926657000000;-0.250505500000000,-0.245613355721111,-0.232805555721111,-0.216974244278889,-0.204166444278889,-0.199274300000000;-0.134457015000000,-0.131831191947457,-0.124956697947457,-0.116459356052543,-0.109584862052543,-0.106959039000000;-0.0468578950000000,-0.0459428029842757,-0.0435470609842757,-0.0405857610157244,-0.0381900190157244,-0.0372749270000000;-0.00934125500000000,-0.00915882879695897,-0.00868123079695897,-0.00809088720304103,-0.00761328920304103,-0.00743086300000000;0,0,0,0,0,0;];
z(1:N1(komp),1:M1(komp),komp) = [0,0.724780506347074,2.62228050634707,4.96771949365292,6.86521949365293,7.59000000000000;0,0.724070922072010,2.61971320632201,4.96285593067799,6.85849821492799,7.58256913700000;0,0.721221067550617,2.60940233580062,4.94332273719938,6.83150400544938,7.55272507300000;0,0.714566826973581,2.58532706722358,4.89771389377642,6.76847413402642,7.48304096100000;0,0.705751503968160,2.55343292896816,4.83729277103184,6.68497419603184,7.39072570000000;0,0.697763414684420,2.52453175043442,4.78254159256558,6.60930992831558,7.30707334300000;0,0.694648305871836,2.51326118087184,4.76119031912816,6.57980319412816,7.27445150000000;0,0.695111275892549,2.51493622214255,4.76436356285745,6.58418850910745,7.27929978500000;0,0.698320746734451,2.52654819673445,4.78636160326555,6.61458905326555,7.31290980000000;0,0.703624721228163,2.54573815672816,4.82271558527184,6.66482902077184,7.36845374200000;0,0.710254108422745,2.56972350492275,4.86815408107725,6.72762347757725,7.43787758600000;0,0.716970431940912,2.59402339169091,4.91418844730909,6.79124140705909,7.50821183900000;0,0.724780506347074,2.62228050634707,4.96771949365292,6.86521949365293,7.59000000000000;0,0.716970431940912,2.59402339169091,4.91418844730909,6.79124140705909,7.50821183900000;0,0.710254108422745,2.56972350492275,4.86815408107725,6.72762347757725,7.43787758600000;0,0.703624721228163,2.54573815672816,4.82271558527184,6.66482902077184,7.36845374200000;0,0.698320746734451,2.52654819673445,4.78636160326555,6.61458905326555,7.31290980000000;0,0.695111275892549,2.51493622214255,4.76436356285745,6.58418850910745,7.27929978500000;0,0.694648305871836,2.51326118087184,4.76119031912816,6.57980319412816,7.27445150000000;0,0.697763414684420,2.52453175043442,4.78254159256558,6.60930992831558,7.30707334300000;0,0.705751503968160,2.55343292896816,4.83729277103184,6.68497419603184,7.39072570000000;0,0.714566826973581,2.58532706722358,4.89771389377642,6.76847413402642,7.48304096100000;0,0.721221067550617,2.60940233580062,4.94332273719938,6.83150400544938,7.55272507300000;0,0.724070922072010,2.61971320632201,4.96285593067799,6.85849821492799,7.58256913700000;0,0.724780506347074,2.62228050634707,4.96771949365292,6.86521949365293,7.59000000000000;];
lift(komp) = 1;

% left horizontal stabilizer
komp = komp+1;
M1(komp) = 6;
N1(komp) = 25;
x(1:N1(komp),1:M1(komp),komp) = [30.3887500000000,30.0678985505499,29.2278985505499,28.1896014494501,27.3496014494501,27.0287500000000;30.3516091220000,30.0256980188911,29.1724516736411,28.1177811893589,27.2645348441089,26.9386237410000;30.2427176860000,29.9019724437368,29.0098898179868,27.9072150510132,27.0151324252632,26.6743871830000;30.0694964120000,29.7051534601518,28.7512912286518,27.5722526693482,26.6183904378482,26.2540474860000;29.8437500000000,29.4486539071132,28.4142789071132,27.1357210928868,26.1013460928868,25.7062500000000;29.5808629280000,29.1499540701136,28.0218200341136,26.6273696778864,25.4992356418864,25.0683267840000;29.2987500000000,28.8294092636764,27.6006592636764,26.0818407363236,24.8530907363236,24.3837500000000;29.0166372900000,28.5088647049371,27.1794988186871,25.5363122163129,24.2069463300629,23.6991737450000;28.7537500000000,28.2101646202397,26.7870396202397,25.0279603797603,23.6048353797603,23.0612500000000;28.5280035880000,27.9536650672010,26.4500272987010,24.5914288032990,23.0877910347990,22.5134525140000;28.3547823140000,27.7568460836161,26.1914287093661,24.2564664216339,22.6910490473839,22.0931128170000;28.2458908780000,27.6331205084617,26.0288668537117,24.0459002832883,22.4416466285383,21.8288762590000;28.2087500000000,27.5909199768030,25.9734199768030,23.9740800231970,22.3565800231970,21.7387500000000;28.2458908780000,27.6331205084617,26.0288668537117,24.0459002832883,22.4416466285383,21.8288762590000;28.3547823140000,27.7568460836161,26.1914287093661,24.2564664216339,22.6910490473839,22.0931128170000;28.5280035880000,27.9536650672010,26.4500272987010,24.5914288032990,23.0877910347990,22.5134525140000;28.7537500000000,28.2101646202397,26.7870396202397,25.0279603797603,23.6048353797603,23.0612500000000;29.0166372900000,28.5088647049371,27.1794988186871,25.5363122163129,24.2069463300629,23.6991737450000;29.2987500000000,28.8294092636764,27.6006592636764,26.0818407363236,24.8530907363236,24.3837500000000;29.5808629280000,29.1499540701136,28.0218200341136,26.6273696778864,25.4992356418864,25.0683267840000;29.8437500000000,29.4486539071132,28.4142789071132,27.1357210928868,26.1013460928868,25.7062500000000;30.0694964120000,29.7051534601518,28.7512912286518,27.5722526693482,26.6183904378482,26.2540474860000;30.2427176860000,29.9019724437368,29.0098898179868,27.9072150510132,27.0151324252632,26.6743871830000;30.3516091220000,30.0256980188911,29.1724516736411,28.1177811893589,27.2645348441089,26.9386237410000;30.3887500000000,30.0678985505499,29.2278985505499,28.1896014494501,27.3496014494501,27.0287500000000;];
y(1:N1(komp),1:M1(komp),komp) = [-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05988029421546,-5.83423800996546,-3.08319285303455,-0.857550568784546,-0.00743086300000000;-8.91000000000000,-8.06273014873685,-5.84454888048685,-3.10272604651315,-0.884544778263152,-0.0372749270000000;-8.91000000000000,-8.06938438931388,-5.86862414906388,-3.14833488993612,-0.947574649686116,-0.106959039000000;-8.91000000000000,-8.07819971231931,-5.90051828731931,-3.20875601268070,-1.03107458768070,-0.199274300000000;-8.91000000000000,-8.08618780160304,-5.92941946585305,-3.26350719114696,-1.10673885539696,-0.282926657000000;-8.91000000000000,-8.08930291041563,-5.94069003541563,-3.28485846458437,-1.13624558958437,-0.315548500000000;-8.91000000000000,-8.08883994039492,-5.93901499414492,-3.28168522085509,-1.13186027460508,-0.310700215000000;-8.91000000000000,-8.08563046955301,-5.92740301955301,-3.25968718044699,-1.10145973044699,-0.277090200000000;-8.91000000000000,-8.08032649505930,-5.90821305955930,-3.22333319844070,-1.05121976294070,-0.221546258000000;-8.91000000000000,-8.07369710786472,-5.88422771136472,-3.17789470263528,-0.988425306135280,-0.152122414000000;-8.91000000000000,-8.06698078434655,-5.85992782459655,-3.13186033640345,-0.924807376653447,-0.0817881610000000;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;-8.91000000000000,-8.05917070994039,-5.83167070994039,-3.07832929005961,-0.850829290059610,0;];
z(1:N1(komp),1:M1(komp),komp) = [7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.58693775400000,7.58652058819746,7.58542843394746,7.58407845705254,7.58298630280254,7.58256913700000;7.57463906600000,7.57254646587581,7.56706796762581,7.56029617137419,7.55481767312419,7.55272507300000;7.54592236200000,7.53991772251955,7.52419737226955,7.50476595073045,7.48904560048045,7.48304096100000;7.50787940000000,7.49669221712695,7.46740379212695,7.43120130787305,7.40191288287305,7.39072570000000;7.47340640600000,7.45752301184672,7.41593974609672,7.36454000290328,7.32295673715328,7.30707334300000;7.45996300000000,7.44224822807600,7.39587035307599,7.33854414692401,7.29216627192401,7.27445150000000;7.46196097000000,7.44451837893883,7.39885308268883,7.34240767231117,7.29674237606117,7.27929978500000;7.47581160000000,7.46025586230713,7.41953041230713,7.36919098769287,7.32846553769287,7.31290980000000;7.49870116400000,7.48626364193576,7.45370178643576,7.41345311956424,7.38089126406424,7.36845374200000;7.52731061200000,7.51877051794619,7.49641226144619,7.46877593655381,7.44641768005381,7.43787758600000;7.55629523800000,7.55170368196916,7.53968283221916,7.52482424478084,7.51280339503084,7.50821183900000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.62370476200000,7.62829631803085,7.64031716778084,7.65517575521916,7.66719660496916,7.67178816100000;7.65268938800000,7.66122948205381,7.68358773855381,7.71122406344619,7.73358231994619,7.74212241400000;7.68129883600000,7.69373635806424,7.72629821356424,7.76654688043576,7.79910873593576,7.81154625800000;7.70418840000000,7.71974413769287,7.76046958769287,7.81080901230713,7.85153446230714,7.86709020000000;7.71803903000000,7.73548162106117,7.78114691731117,7.83759232768883,7.88325762393883,7.90070021500000;7.72003700000000,7.73775177192401,7.78412964692401,7.84145585307599,7.88783372807600,7.90554850000000;7.70659359400000,7.72247698815328,7.76406025390328,7.81545999709672,7.85704326284672,7.87292665700000;7.67212060000000,7.68330778287305,7.71259620787305,7.74879869212695,7.77808711712695,7.78927430000000;7.63407763800000,7.64008227748045,7.65580262773045,7.67523404926955,7.69095439951955,7.69695903900000;7.60536093400000,7.60745353412419,7.61293203237419,7.61970382862581,7.62518232687581,7.62727492700000;7.59306224600000,7.59347941180254,7.59457156605254,7.59592154294746,7.59701369719746,7.59743086300000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;];
lift(komp) = 1;

% right horizontal stabilizer
komp = komp+1;
M1(komp) = 6;
N1(komp) = 25;
x(1:N1(komp),1:M1(komp),komp) = [27.0287500000000,27.3496014494501,28.1896014494501,29.2278985505499,30.0678985505499,30.3887500000000;26.9386237410000,27.2645348441089,28.1177811893589,29.1724516736411,30.0256980188911,30.3516091220000;26.6743871830000,27.0151324252632,27.9072150510132,29.0098898179868,29.9019724437368,30.2427176860000;26.2540474860000,26.6183904378482,27.5722526693482,28.7512912286518,29.7051534601518,30.0694964120000;25.7062500000000,26.1013460928868,27.1357210928868,28.4142789071132,29.4486539071132,29.8437500000000;25.0683267840000,25.4992356418864,26.6273696778864,28.0218200341136,29.1499540701136,29.5808629280000;24.3837500000000,24.8530907363236,26.0818407363236,27.6006592636764,28.8294092636764,29.2987500000000;23.6991737450000,24.2069463300629,25.5363122163129,27.1794988186871,28.5088647049371,29.0166372900000;23.0612500000000,23.6048353797603,25.0279603797603,26.7870396202397,28.2101646202397,28.7537500000000;22.5134525140000,23.0877910347990,24.5914288032990,26.4500272987010,27.9536650672011,28.5280035880000;22.0931128170000,22.6910490473839,24.2564664216339,26.1914287093661,27.7568460836161,28.3547823140000;21.8288762590000,22.4416466285383,24.0459002832883,26.0288668537117,27.6331205084617,28.2458908780000;21.7387500000000,22.3565800231970,23.9740800231970,25.9734199768030,27.5909199768030,28.2087500000000;21.8288762590000,22.4416466285383,24.0459002832883,26.0288668537117,27.6331205084617,28.2458908780000;22.0931128170000,22.6910490473839,24.2564664216339,26.1914287093661,27.7568460836161,28.3547823140000;22.5134525140000,23.0877910347990,24.5914288032990,26.4500272987010,27.9536650672011,28.5280035880000;23.0612500000000,23.6048353797603,25.0279603797603,26.7870396202397,28.2101646202397,28.7537500000000;23.6991737450000,24.2069463300629,25.5363122163129,27.1794988186871,28.5088647049371,29.0166372900000;24.3837500000000,24.8530907363236,26.0818407363236,27.6006592636764,28.8294092636764,29.2987500000000;25.0683267840000,25.4992356418864,26.6273696778864,28.0218200341136,29.1499540701136,29.5808629280000;25.7062500000000,26.1013460928868,27.1357210928868,28.4142789071132,29.4486539071132,29.8437500000000;26.2540474860000,26.6183904378482,27.5722526693482,28.7512912286518,29.7051534601518,30.0694964120000;26.6743871830000,27.0151324252632,27.9072150510132,29.0098898179868,29.9019724437368,30.2427176860000;26.9386237410000,27.2645348441089,28.1177811893589,29.1724516736411,30.0256980188911,30.3516091220000;27.0287500000000,27.3496014494501,28.1896014494501,29.2278985505499,30.0678985505499,30.3887500000000;];
y(1:N1(komp),1:M1(komp),komp) = [0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0.00743086300000000,0.857550568784545,3.08319285303455,5.83423800996545,8.05988029421546,8.91000000000000;0.0372749270000000,0.884544778263152,3.10272604651315,5.84454888048685,8.06273014873685,8.91000000000000;0.106959039000000,0.947574649686116,3.14833488993612,5.86862414906388,8.06938438931388,8.91000000000000;0.199274300000000,1.03107458768070,3.20875601268070,5.90051828731930,8.07819971231931,8.91000000000000;0.282926657000000,1.10673885539696,3.26350719114696,5.92941946585304,8.08618780160304,8.91000000000000;0.315548500000000,1.13624558958437,3.28485846458437,5.94069003541563,8.08930291041563,8.91000000000000;0.310700215000000,1.13186027460508,3.28168522085508,5.93901499414492,8.08883994039492,8.91000000000000;0.277090200000000,1.10145973044699,3.25968718044699,5.92740301955301,8.08563046955302,8.91000000000000;0.221546258000000,1.05121976294070,3.22333319844070,5.90821305955930,8.08032649505930,8.91000000000000;0.152122414000000,0.988425306135280,3.17789470263528,5.88422771136472,8.07369710786472,8.91000000000000;0.0817881610000000,0.924807376653446,3.13186033640345,5.85992782459655,8.06698078434655,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;0,0.850829290059609,3.07832929005961,5.83167070994039,8.05917070994039,8.91000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.58256913700000,7.58298630280254,7.58407845705254,7.58542843394746,7.58652058819746,7.58693775400000;7.55272507300000,7.55481767312419,7.56029617137419,7.56706796762581,7.57254646587581,7.57463906600000;7.48304096100000,7.48904560048045,7.50476595073045,7.52419737226955,7.53991772251955,7.54592236200000;7.39072570000000,7.40191288287305,7.43120130787305,7.46740379212695,7.49669221712695,7.50787940000000;7.30707334300000,7.32295673715328,7.36454000290328,7.41593974609672,7.45752301184672,7.47340640600000;7.27445150000000,7.29216627192401,7.33854414692401,7.39587035307599,7.44224822807600,7.45996300000000;7.27929978500000,7.29674237606117,7.34240767231117,7.39885308268883,7.44451837893883,7.46196097000000;7.31290980000000,7.32846553769287,7.36919098769287,7.41953041230713,7.46025586230713,7.47581160000000;7.36845374200000,7.38089126406424,7.41345311956424,7.45370178643576,7.48626364193576,7.49870116400000;7.43787758600000,7.44641768005381,7.46877593655381,7.49641226144619,7.51877051794619,7.52731061200000;7.50821183900000,7.51280339503084,7.52482424478084,7.53968283221916,7.55170368196916,7.55629523800000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.67178816100000,7.66719660496916,7.65517575521916,7.64031716778084,7.62829631803085,7.62370476200000;7.74212241400000,7.73358231994619,7.71122406344619,7.68358773855381,7.66122948205381,7.65268938800000;7.81154625800000,7.79910873593576,7.76654688043576,7.72629821356424,7.69373635806424,7.68129883600000;7.86709020000000,7.85153446230713,7.81080901230713,7.76046958769287,7.71974413769287,7.70418840000000;7.90070021500000,7.88325762393883,7.83759232768883,7.78114691731117,7.73548162106117,7.71803903000000;7.90554850000000,7.88783372807600,7.84145585307599,7.78412964692401,7.73775177192401,7.72003700000000;7.87292665700000,7.85704326284672,7.81545999709672,7.76406025390328,7.72247698815328,7.70659359400000;7.78927430000000,7.77808711712695,7.74879869212695,7.71259620787305,7.68330778287305,7.67212060000000;7.69695903900000,7.69095439951955,7.67523404926955,7.65580262773045,7.64008227748045,7.63407763800000;7.62727492700000,7.62518232687581,7.61970382862581,7.61293203237419,7.60745353412419,7.60536093400000;7.59743086300000,7.59701369719746,7.59592154294746,7.59457156605254,7.59347941180254,7.59306224600000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;];
lift(komp) = 1;

% left horizontal stabilizer wingtip
komp = komp+1;
M1(komp) = 5;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [28.2087500000000,28.2087500000000,28.2087500000000,28.2087500000000,28.2087500000000;28.2458908780000,28.2631971228397,28.2703656041661,28.2631971228397,28.2458908780000;28.3547823140000,28.3869711749562,28.4003042377217,28.3869711749562,28.3547823140000;28.5280035880000,28.5748824239757,28.5943002736251,28.5748824239757,28.5280035880000;28.7537500000000,28.8123818457985,28.8366679515152,28.8123818457985,28.7537500000000;29.0166372900000,29.0823809615388,29.1096128819304,29.0823809615388,29.0166372900000;29.2987500000000,29.3655195609370,29.3931764186308,29.3655195609370,29.2987500000000;29.5808629280000,29.6407297588208,29.6655274120831,29.6407297588208,29.5808629280000;29.8437500000000,29.8859161250712,29.9033819059484,29.8859161250712,29.8437500000000;30.0694964120000,30.0921287746076,30.1015034061482,30.0921287746076,30.0694964120000;30.2427176860000,30.2506050012930,30.2538720342581,30.2506050012930,30.2427176860000;30.3516091220000,30.3531814807971,30.3538327731358,30.3531814807971,30.3516091220000;30.3887500000000,30.3887500000000,30.3887500000000,30.3887500000000,30.3887500000000;];
y(1:N1(komp),1:M1(komp),komp) = [-8.91000000000000,-8.91000000000000,-8.91000000000000,-8.91000000000000,-8.91000000000000;-8.91000000000000,-8.93383286576848,-8.94370476200000,-8.93383286576848,-8.91000000000000;-8.91000000000000,-8.95432809136324,-8.97268938800000,-8.95432809136324,-8.91000000000000;-8.91000000000000,-8.97455802605004,-9.00129883600000,-8.97455802605004,-8.91000000000000;-8.91000000000000,-8.99074339197284,-9.02418840000000,-8.99074339197284,-8.91000000000000;-8.91000000000000,-9.00053726636955,-9.03803903000000,-9.00053726636955,-8.91000000000000;-8.91000000000000,-9.00195004450516,-9.04003700000000,-9.00195004450516,-8.91000000000000;-8.91000000000000,-8.99244412096031,-9.02659359400000,-8.99244412096031,-8.91000000000000;-8.91000000000000,-8.96806803313511,-8.99212060000000,-8.96806803313511,-8.91000000000000;-8.91000000000000,-8.94116759672849,-8.95407763800000,-8.94116759672849,-8.91000000000000;-8.91000000000000,-8.92086182059676,-8.92536093400000,-8.92086182059676,-8.91000000000000;-8.91000000000000,-8.91216533491226,-8.91306224600000,-8.91216533491226,-8.91000000000000;-8.91000000000000,-8.91000000000000,-8.91000000000000,-8.91000000000000,-8.91000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.55629523800000,7.56616713423152,7.59000000000000,7.61383286576848,7.62370476200000;7.52731061200000,7.54567190863677,7.59000000000000,7.63432809136323,7.65268938800000;7.49870116400000,7.52544197394996,7.59000000000000,7.65455802605004,7.68129883600000;7.47581160000000,7.50925660802716,7.59000000000000,7.67074339197284,7.70418840000000;7.46196097000000,7.49946273363045,7.59000000000000,7.68053726636955,7.71803903000000;7.45996300000000,7.49804995549485,7.59000000000000,7.68195004450516,7.72003700000000;7.47340640600000,7.50755587903969,7.59000000000000,7.67244412096031,7.70659359400000;7.50787940000000,7.53193196686489,7.59000000000000,7.64806803313511,7.67212060000000;7.54592236200000,7.55883240327151,7.59000000000000,7.62116759672849,7.63407763800000;7.57463906600000,7.57913817940324,7.59000000000000,7.60086182059676,7.60536093400000;7.58693775400000,7.58783466508774,7.59000000000000,7.59216533491226,7.59306224600000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;];
lift(komp) = 0;

% right horizontal stabilizer wingtip
komp = komp+1;
M1(komp) = 5;
N1(komp) = 13;
x(1:N1(komp),1:M1(komp),komp) = [28.2087500000000,28.2087500000000,28.2087500000000,28.2087500000000,28.2087500000000;28.2458908780000,28.2631971228397,28.2703656041661,28.2631971228397,28.2458908780000;28.3547823140000,28.3869711749562,28.4003042377217,28.3869711749562,28.3547823140000;28.5280035880000,28.5748824239757,28.5943002736251,28.5748824239757,28.5280035880000;28.7537500000000,28.8123818457985,28.8366679515152,28.8123818457985,28.7537500000000;29.0166372900000,29.0823809615388,29.1096128819304,29.0823809615388,29.0166372900000;29.2987500000000,29.3655195609370,29.3931764186308,29.3655195609370,29.2987500000000;29.5808629280000,29.6407297588208,29.6655274120831,29.6407297588208,29.5808629280000;29.8437500000000,29.8859161250712,29.9033819059484,29.8859161250712,29.8437500000000;30.0694964120000,30.0921287746076,30.1015034061482,30.0921287746076,30.0694964120000;30.2427176860000,30.2506050012930,30.2538720342581,30.2506050012930,30.2427176860000;30.3516091220000,30.3531814807971,30.3538327731358,30.3531814807971,30.3516091220000;30.3887500000000,30.3887500000000,30.3887500000000,30.3887500000000,30.3887500000000;];
y(1:N1(komp),1:M1(komp),komp) = [8.91000000000000,8.91000000000000,8.91000000000000,8.91000000000000,8.91000000000000;8.91000000000000,8.93383286576848,8.94370476200000,8.93383286576848,8.91000000000000;8.91000000000000,8.95432809136324,8.97268938800000,8.95432809136324,8.91000000000000;8.91000000000000,8.97455802605004,9.00129883600000,8.97455802605004,8.91000000000000;8.91000000000000,8.99074339197284,9.02418840000000,8.99074339197284,8.91000000000000;8.91000000000000,9.00053726636955,9.03803903000000,9.00053726636955,8.91000000000000;8.91000000000000,9.00195004450516,9.04003700000000,9.00195004450516,8.91000000000000;8.91000000000000,8.99244412096031,9.02659359400000,8.99244412096031,8.91000000000000;8.91000000000000,8.96806803313511,8.99212060000000,8.96806803313511,8.91000000000000;8.91000000000000,8.94116759672849,8.95407763800000,8.94116759672849,8.91000000000000;8.91000000000000,8.92086182059676,8.92536093400000,8.92086182059676,8.91000000000000;8.91000000000000,8.91216533491226,8.91306224600000,8.91216533491226,8.91000000000000;8.91000000000000,8.91000000000000,8.91000000000000,8.91000000000000,8.91000000000000;];
z(1:N1(komp),1:M1(komp),komp) = [7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;7.62370476200000,7.61383286576848,7.59000000000000,7.56616713423152,7.55629523800000;7.65268938800000,7.63432809136323,7.59000000000000,7.54567190863677,7.52731061200000;7.68129883600000,7.65455802605004,7.59000000000000,7.52544197394996,7.49870116400000;7.70418840000000,7.67074339197284,7.59000000000000,7.50925660802716,7.47581160000000;7.71803903000000,7.68053726636955,7.59000000000000,7.49946273363045,7.46196097000000;7.72003700000000,7.68195004450516,7.59000000000000,7.49804995549485,7.45996300000000;7.70659359400000,7.67244412096031,7.59000000000000,7.50755587903969,7.47340640600000;7.67212060000000,7.64806803313511,7.59000000000000,7.53193196686489,7.50787940000000;7.63407763800000,7.62116759672849,7.59000000000000,7.55883240327151,7.54592236200000;7.60536093400000,7.60086182059676,7.59000000000000,7.57913817940324,7.57463906600000;7.59306224600000,7.59216533491226,7.59000000000000,7.58783466508774,7.58693775400000;7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000,7.59000000000000;];
lift(komp) = 0;

% number of panels by components
M = zeros(komp,1);
N = zeros(komp,1);
O = zeros(komp,1);
numpan = 0;
for i = 1:komp
    M(i) = M1(i)-1;
    N(i) = N1(i)-1;
    O(i) = M(i)*N(i);
    numpan = numpan + O(i);
end
maxN = max(N);
maxN1 = max(N1);
maxM = max(M);
maxO = max(O);

% calculation of grid information
FF = zeros(maxN1,maxM,komp);
S = zeros(maxN1,maxM,komp);
u1 = zeros(maxN1,maxM,komp);
u2 = zeros(maxN1,maxM,komp);
u3 = zeros(maxN1,maxM,komp);
o1 = zeros(maxN1,maxM,komp);
o2 = zeros(maxN1,maxM,komp);
o3 = zeros(maxN1,maxM,komp);
n1 = zeros(maxN1,maxM,komp);
n2 = zeros(maxN1,maxM,komp);
n3 = zeros(maxN1,maxM,komp);
p1 = zeros(maxN1,maxM,komp);
p2 = zeros(maxN1,maxM,komp);
p3 = zeros(maxN1,maxM,komp);
cx = zeros(maxN1,maxM,komp);
cy = zeros(maxN1,maxM,komp);
cz = zeros(maxN1,maxM,komp);
x1 = zeros(maxN1,maxM,komp);
y1 = zeros(maxN1,maxM,komp);
x2 = zeros(maxN1,maxM,komp);
y2 = zeros(maxN1,maxM,komp);
x3 = zeros(maxN1,maxM,komp);
y3 = zeros(maxN1,maxM,komp);
x4 = zeros(maxN1,maxM,komp);
y4 = zeros(maxN1,maxM,komp);
d1 = zeros(maxN1,maxM,komp);
d2 = zeros(maxN1,maxM,komp);
d3 = zeros(maxN1,maxM,komp);
d4 = zeros(maxN1,maxM,komp);
for i = 1:komp
    [FF(1:N1(i),1:M(i),i),S(1:N1(i),1:M(i),i),u1(1:N1(i),1:M(i),i),u2(1:N1(i),1:M(i),i),u3(1:N1(i),1:M(i),i),o1(1:N1(i),1:M(i),i),o2(1:N1(i),1:M(i),i),o3(1:N1(i),1:M(i),i),n1(1:N1(i),1:M(i),i),n2(1:N1(i),1:M(i),i),n3(1:N1(i),1:M(i),i),p1(1:N1(i),1:M(i),i),p2(1:N1(i),1:M(i),i),p3(1:N1(i),1:M(i),i),cx(1:N1(i),1:M(i),i),cy(1:N1(i),1:M(i),i),cz(1:N1(i),1:M(i),i),x1(1:N1(i),1:M(i),i),y1(1:N1(i),1:M(i),i),x2(1:N1(i),1:M(i),i),y2(1:N1(i),1:M(i),i),x3(1:N1(i),1:M(i),i),y3(1:N1(i),1:M(i),i),x4(1:N1(i),1:M(i),i),y4(1:N1(i),1:M(i),i),d1(1:N1(i),1:M(i),i),d2(1:N1(i),1:M(i),i),d3(1:N1(i),1:M(i),i),d4(1:N1(i),1:M(i),i)]=grid_calculation(x(1:N1(i),1:M1(i),i),y(1:N1(i),1:M1(i),i),z(1:N1(i),1:M1(i),i),M(i),N(i),M1(i),N1(i),farpoint,farfieldfaktor);
end
disp('Geometry processing time=')
disp(toc)

%%%%%%%%%%%%% INFLUENCE COEFFICIENTS CALCULATION %%%%%%%%%%%%%
tic
a = zeros(numpan,numpan,'single');
b = zeros(numpan,numpan,'single');
sigma = zeros(1,numpan,'single');
I = 1;
for i = 1:komp
    J = 1;
    for j = 1:komp
        if i == j
            if lift(j) == 1
                [a(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),b(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),sigma(I:I+N(j)*M(j)-1)]=influence_self_lift(FF(1:N1(j),1:M(j),j),error,Vx,Vy,Vz,S(1:N1(j),1:M(j),j),M(j),N(j),N1(j),O(j),u1(1:N1(j),1:M(j),j),u2(1:N1(j),1:M(j),j),u3(1:N1(j),1:M(j),j),o1(1:N1(j),1:M(j),j),o2(1:N1(j),1:M(j),j),o3(1:N1(j),1:M(j),j),n1(1:N1(j),1:M(j),j),n2(1:N1(j),1:M(j),j),n3(1:N1(j),1:M(j),j),cx(1:N1(j),1:M(j),j),cy(1:N1(j),1:M(j),j),cz(1:N1(j),1:M(j),j),x1(1:N1(j),1:M(j),j),y1(1:N1(j),1:M(j),j),x2(1:N1(j),1:M(j),j),y2(1:N1(j),1:M(j),j),x3(1:N1(j),1:M(j),j),y3(1:N1(j),1:M(j),j),x4(1:N1(j),1:M(j),j),y4(1:N1(j),1:M(j),j),d1(1:N1(j),1:M(j),j),d2(1:N1(j),1:M(j),j),d3(1:N1(j),1:M(j),j),d4(1:N1(j),1:M(j),j));
            else
                [a(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),b(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),sigma(I:I+N(j)*M(j)-1)]=influence_self_nolift(FF(1:N1(j),1:M(j),j),error,Vx,Vy,Vz,S(1:N1(j),1:M(j),j),M(j),N(j),O(j),u1(1:N1(j),1:M(j),j),u2(1:N1(j),1:M(j),j),u3(1:N1(j),1:M(j),j),o1(1:N1(j),1:M(j),j),o2(1:N1(j),1:M(j),j),o3(1:N1(j),1:M(j),j),n1(1:N1(j),1:M(j),j),n2(1:N1(j),1:M(j),j),n3(1:N1(j),1:M(j),j),cx(1:N1(j),1:M(j),j),cy(1:N1(j),1:M(j),j),cz(1:N1(j),1:M(j),j),x1(1:N1(j),1:M(j),j),y1(1:N1(j),1:M(j),j),x2(1:N1(j),1:M(j),j),y2(1:N1(j),1:M(j),j),x3(1:N1(j),1:M(j),j),y3(1:N1(j),1:M(j),j),x4(1:N1(j),1:M(j),j),y4(1:N1(j),1:M(j),j),d1(1:N1(j),1:M(j),j),d2(1:N1(j),1:M(j),j),d3(1:N1(j),1:M(j),j),d4(1:N1(j),1:M(j),j));
            end
        else
            if lift(j) == 1
                [a(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),b(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1)]=influence_other_lift(FF(1:N1(j),1:M(j),j),error,S(1:N1(j),1:M(j),j),M(j),N(j),N1(j),O(j),u1(1:N1(j),1:M(j),j),u2(1:N1(j),1:M(j),j),u3(1:N1(j),1:M(j),j),o1(1:N1(j),1:M(j),j),o2(1:N1(j),1:M(j),j),o3(1:N1(j),1:M(j),j),n1(1:N1(j),1:M(j),j),n2(1:N1(j),1:M(j),j),n3(1:N1(j),1:M(j),j),cx(1:N1(j),1:M(j),j),cy(1:N1(j),1:M(j),j),cz(1:N1(j),1:M(j),j),x1(1:N1(j),1:M(j),j),y1(1:N1(j),1:M(j),j),x2(1:N1(j),1:M(j),j),y2(1:N1(j),1:M(j),j),x3(1:N1(j),1:M(j),j),y3(1:N1(j),1:M(j),j),x4(1:N1(j),1:M(j),j),y4(1:N1(j),1:M(j),j),d1(1:N1(j),1:M(j),j),d2(1:N1(j),1:M(j),j),d3(1:N1(j),1:M(j),j),d4(1:N1(j),1:M(j),j),M(i),N(i),cx(1:N1(i),1:M(i),i),cy(1:N1(i),1:M(i),i),cz(1:N1(i),1:M(i),i));
            else
                [a(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1),b(I:I+N(i)*M(i)-1,J:J+N(j)*M(j)-1)]=influence_other_nolift(FF(1:N1(j),1:M(j),j),error,S(1:N1(j),1:M(j),j),M(j),N(j),u1(1:N1(j),1:M(j),j),u2(1:N1(j),1:M(j),j),u3(1:N1(j),1:M(j),j),o1(1:N1(j),1:M(j),j),o2(1:N1(j),1:M(j),j),o3(1:N1(j),1:M(j),j),n1(1:N1(j),1:M(j),j),n2(1:N1(j),1:M(j),j),n3(1:N1(j),1:M(j),j),cx(1:N1(j),1:M(j),j),cy(1:N1(j),1:M(j),j),cz(1:N1(j),1:M(j),j),x1(1:N1(j),1:M(j),j),y1(1:N1(j),1:M(j),j),x2(1:N1(j),1:M(j),j),y2(1:N1(j),1:M(j),j),x3(1:N1(j),1:M(j),j),y3(1:N1(j),1:M(j),j),x4(1:N1(j),1:M(j),j),y4(1:N1(j),1:M(j),j),d1(1:N1(j),1:M(j),j),d2(1:N1(j),1:M(j),j),d3(1:N1(j),1:M(j),j),d4(1:N1(j),1:M(j),j),M(i),N(i),cx(1:N1(i),1:M(i),i),cy(1:N1(i),1:M(i),i),cz(1:N1(i),1:M(i),i));
            end
        end
        J = J+N(j)*M(j);
    end
    I = I+N(i)*M(i);
end
disp('Influence coefficients calculation time=')
disp(toc)

//SOLVING SYSTEM OF EQUATIONS 
tic
RHS = b*sigma';
clear b sigma
gamaglobal = a\RHS;
clear a RHS FF d1 d2 d3 d4 x1 x2 x3 x4 y1 y2 y3 y4
disp('System of equations solving time=')
disp(toc)

tic
% distribution of dipole values to components
gama = zeros(maxO,komp);
I = 1;
for i = 1:komp
    gama(1:N(i)*M(i),i) = gamaglobal(I:I+N(i)*M(i)-1);
    I = I+N(i)*M(i);
end
clear gamaglobal
% returning dipole values to i,j matrix
gam = zeros(maxN,maxM,komp);
for i = 1:komp
    K = 0;
    for k = 1:N(i)
        for l = 1:M(i)
            K = K+1;
            gam(k,l,i) = gama(K,i);
        end
    end
end
clear gama

//CALCULATION OF SPEEDS, PRESSURES AND FORCES 
v = zeros(maxN,maxM,komp);
vx = zeros(maxN,maxM,komp);
vy = zeros(maxN,maxM,komp);
vz = zeros(maxN,maxM,komp);
cp = zeros(maxN,maxM,komp);
CX = zeros(1,komp);
CY = zeros(1,komp);
CZ = zeros(1,komp);
CL = zeros(1,komp);
CM = zeros(1,komp);
CN = zeros(1,komp);
Cx = 0;
Cy = 0;
Cz = 0;
Cl = 0;
Cm = 0;
Cn = 0;
for i = 1:komp
    [v(1:N(i),1:M(i),i),vx(1:N(i),1:M(i),i),vy(1:N(i),1:M(i),i),vz(1:N(i),1:M(i),i),cp(1:N(i),1:M(i),i),CX(i),CY(i),CZ(i),CL(i),CM(i),CN(i)]=speed_pressure_force(c,span,Sw,gam(1:N(i),1:M(i),i),V,ro,Vx,Vy,Vz,S(1:N1(i),1:M(i),i),M(i),N(i),u1(1:N1(i),1:M(i),i),u2(1:N1(i),1:M(i),i),u3(1:N1(i),1:M(i),i),n1(1:N1(i),1:M(i),i),n2(1:N1(i),1:M(i),i),n3(1:N1(i),1:M(i),i),p1(1:N1(i),1:M(i),i),p2(1:N1(i),1:M(i),i),p3(1:N1(i),1:M(i),i),o1(1:N1(i),1:M(i),i),o2(1:N1(i),1:M(i),i),o3(1:N1(i),1:M(i),i),cx(1:N1(i),1:M(i),i),cy(1:N1(i),1:M(i),i),cz(1:N1(i),1:M(i),i));
    Cx = Cx + CX(i);
    Cy = Cy + CY(i);
    Cz = Cz + CZ(i);
    Cl = Cl + CL(i);
    Cm = Cm + CM(i);
    Cn = Cn + CN(i);
end
disp('Cx=')
disp(Cx)
disp('Cy=')
disp(Cy)
disp('Cz=')
disp(Cz)
disp('Cl=')
disp(Cl)
disp('Cm=')
disp(Cm)
disp('Cn=')
disp(Cn)
disp('Calculation of speeds, pressures and forces time=')
disp(toc)

// VALUES DISPLAY
figure(1)
hold on
axis equal
for i = 1:komp
    surf(cx(1:N(i),1:M(i),i),cy(1:N(i),1:M(i),i),cz(1:N(i),1:M(i),i),cp(1:N(i),1:M(i),i))
    shading interp
    caxis([-0.6,0.9])
    %caxis([min(min(cp(1:N(1),1:M(1),1))) max(max(cp(1:N(1),1:M(1),1)))])
end
figure(2)
hold on
axis equal
for i = 1:komp
    surf(cx(1:N(i),1:M(i),i),cy(1:N(i),1:M(i),i),cz(1:N(i),1:M(i),i),v(1:N(i),1:M(i),i))
    shading interp
    caxis([10,45])
    %caxis([min(min(v(1:N(1),1:M(1),1))) max(max(v(1:N(1),1:M(1),1)))])
end
//GRID DISPLAY 
figure(3)
hold on
axis equal
for i = 1:komp
    colour = zeros(N1(i),M1(i));
    colour(1,1) = 1000;
    mesh(x(1:N1(i),1:M1(i),i),y(1:N1(i),1:M1(i),i),z(1:N1(i),1:M1(i),i),colour)
end


 


% file grid_calculation.m

function [FF,S,u1,u2,u3,o1,o2,o3,n1,n2,n3,p1,p2,p3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4]=grid_calculation(x,y,z,M,N,M1,N1,farpoint,farfieldfaktor)

% calculation of vortex trail coordinates
N2 = N+2;
for j = 1:M1
    x(N2,j) = x(N1,j)+farpoint;
    y(N2,j) = y(N1,j);
    z(N2,j) = z(N1,j);
end

% calculation of panel surfaces and surface normals
K = 0;
S = zeros(N1,M);
FF = zeros(N1,M);
n1 = zeros(N1,M);
n2 = zeros(N1,M);
n3 = zeros(N1,M);
for j = 1:M
    for i = 1:N1
        K = K+1;
        A = [(x(i+1,j+1)-x(i,j)), (y(i+1,j+1)-y(i,j)), (z(i+1,j+1)-z(i,j))];
        B = [(x(i+1,j)-x(i,j+1)), (y(i+1,j)-y(i,j+1)), (z(i+1,j)-z(i,j+1))];
        AA = realsqrt((x(i+1,j+1)-x(i,j))^2 + (y(i+1,j+1)-y(i,j))^2 + (z(i+1,j+1)-z(i,j))^2);
        BB = realsqrt((x(i+1,j)-x(i,j+1))^2 + (y(i+1,j)-y(i,j+1))^2 + (z(i+1,j)-z(i,j+1))^2);
        FF(K) = farfieldfaktor*max(AA,BB);
        C = cross(A,B);
        modc = realsqrt(C(1)^2 + C(2)^2 + C(3)^2);
        S(K) = modc/2;
        if modc == 0
            n1(K) = 0;
            n2(K) = 0;
            n3(K) = 0;
        else
            norm = -C./modc;
            n1(K) = norm(1);
            n2(K) = norm(2);
            n3(K) = norm(3);
        end
    end
end

% calculation of colocation points
cx = zeros(N1,M);
cy = zeros(N1,M);
cz = zeros(N1,M);
K = 0;
for j = 1:M
    for i = 1:N1
        K = K+1;
        cx(K) = (x(i,j) + x(i,j+1) + x(i+1,j) + x(i+1,j+1))/4;
        cy(K) = (y(i,j) + y(i,j+1) + y(i+1,j) + y(i+1,j+1))/4;
        cz(K) = (z(i,j) + z(i,j+1) + z(i+1,j) + z(i+1,j+1))/4;
    end
end

% calculation of u(longitudinal), p(transversal) and o(perpendicular)
% vectors
u1 = zeros(N1,M);
u2 = zeros(N1,M);
u3 = zeros(N1,M);
o1 = zeros(N1,M);
o2 = zeros(N1,M);
o3 = zeros(N1,M);
p1 = zeros(N1,M);
p2 = zeros(N1,M);
p3 = zeros(N1,M);
K = 0;
for j = 1:M
    for i = 1:N1
        K = K+1;
        ux = ((x(i+1,j)+x(i+1,j+1))-(x(i,j)+x(i,j+1)))/2;
        uy = ((y(i+1,j)+y(i+1,j+1))-(y(i,j)+y(i,j+1)))/2;
        uz = ((z(i+1,j)+z(i+1,j+1))-(z(i,j)+z(i,j+1)))/2;
        uu = realsqrt(ux^2 + uy^2 + uz^2);
        u1(K) = ux/uu;
        u2(K) = uy/uu;
        u3(K) = uz/uu;
        px = ((x(i,j+1)+x(i+1,j+1))-(x(i,j)+x(i+1,j)))/2;
        py = ((y(i,j+1)+y(i+1,j+1))-(y(i,j)+y(i+1,j)))/2;
        pz = ((z(i,j+1)+z(i+1,j+1))-(z(i,j)+z(i+1,j)))/2;
        pp = sqrt(px^2 + py^2 + pz^2);
        p1(K) = px/pp;
        p2(K) = py/pp;
        p3(K) = pz/pp;
        o1(K) = n2(i,j)*u3(i,j) - n3(i,j)*u2(i,j);
        o2(K) = u1(i,j)*n3(i,j) - n1(i,j)*u3(i,j);
        o3(K) = n1(i,j)*u2(i,j) - n2(i,j)*u1(i,j);
    end
end

% calculation of panel coordinates and panel side lengths
x1 = zeros(N1,M);
y1 = zeros(N1,M);
x2 = zeros(N1,M);
y2 = zeros(N1,M);
x3 = zeros(N1,M);
y3 = zeros(N1,M);
x4 = zeros(N1,M);
y4 = zeros(N1,M);
d1 = zeros(N1,M);
d2 = zeros(N1,M);
d3 = zeros(N1,M);
d4 = zeros(N1,M);
for j = 1:M
    for i = 1:N1
        x1(i,j) = (x(i,j)-cx(i,j))*u1(i,j)+(y(i,j)-cy(i,j))*u2(i,j)+(z(i,j)-cz(i,j))*u3(i,j);
        y1(i,j) = (x(i,j)-cx(i,j))*o1(i,j)+(y(i,j)-cy(i,j))*o2(i,j)+(z(i,j)-cz(i,j))*o3(i,j);
        x2(i,j) = (x(i+1,j)-cx(i,j))*u1(i,j)+(y(i+1,j)-cy(i,j))*u2(i,j)+(z(i+1,j)-cz(i,j))*u3(i,j);
        y2(i,j) = (x(i+1,j)-cx(i,j))*o1(i,j)+(y(i+1,j)-cy(i,j))*o2(i,j)+(z(i+1,j)-cz(i,j))*o3(i,j);
        x3(i,j) = (x(i+1,j+1)-cx(i,j))*u1(i,j)+(y(i+1,j+1)-cy(i,j))*u2(i,j)+(z(i+1,j+1)-cz(i,j))*u3(i,j);
        y3(i,j) = (x(i+1,j+1)-cx(i,j))*o1(i,j)+(y(i+1,j+1)-cy(i,j))*o2(i,j)+(z(i+1,j+1)-cz(i,j))*o3(i,j);
        x4(i,j) = (x(i,j+1)-cx(i,j))*u1(i,j)+(y(i,j+1)-cy(i,j))*u2(i,j)+(z(i,j+1)-cz(i,j))*u3(i,j);
        y4(i,j) = (x(i,j+1)-cx(i,j))*o1(i,j)+(y(i,j+1)-cy(i,j))*o2(i,j)+(z(i,j+1)-cz(i,j))*o3(i,j);
        d1(i,j) = realsqrt((x2(i,j)-x1(i,j))^2 + (y2(i,j)-y1(i,j))^2);
        d2(i,j) = realsqrt((x3(i,j)-x2(i,j))^2 + (y3(i,j)-y2(i,j))^2);
        d3(i,j) = realsqrt((x4(i,j)-x3(i,j))^2 + (y4(i,j)-y3(i,j))^2);
        d4(i,j) = realsqrt((x1(i,j)-x4(i,j))^2 + (y1(i,j)-y4(i,j))^2);
    end
end



% file influence_other_lift.m

function [atotal,b]=influence_other_lift(FF,ep,S,M,N,N1,O,u1,u2,u3,o1,o2,o3,n1,n2,n3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4,Mdruga,Ndruga,cxdruga,cydruga,czdruga)

% calculation of influence coefficients
a = zeros(Mdruga*Ndruga,M*N);
b = zeros(Mdruga*Ndruga,M*N);
I = 0;
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                cxijcxkl = cxdruga(i,j)-cx(k,l);
                cyijcykl = cydruga(i,j)-cy(k,l);
                czijczkl = czdruga(i,j)-cz(k,l);
                cpx = cxijcxkl*u1(k,l) + cyijcykl*u2(k,l) + czijczkl*u3(k,l);
                cpy = cxijcxkl*o1(k,l) + cyijcykl*o2(k,l) + czijczkl*o3(k,l);
                cpz = cxijcxkl*n1(k,l) + cyijcykl*n2(k,l) + czijczkl*n3(k,l);
                % if distance of panel from influenced point is greater
                % then product of longer diagonal and "far field" coefficient
                if realsqrt(cpx^2+cpy^2+cpz^2) > FF(k,l)
                    rad = cpx^2 + cpy^2 + cpz^2;
                    a(I) = 0.079577471545948*S(k,l)*cpz*rad^(-1.5);
                    b(I) = 0.079577471545948*S(k,l)/realsqrt(rad);
                else
                    cpx1 = cpx - x1(k,l);
                    cpx2 = cpx - x2(k,l);
                    cpx3 = cpx - x3(k,l);
                    cpx4 = cpx - x4(k,l);
                    cpy1 = cpy - y1(k,l);
                    cpy2 = cpy - y2(k,l);
                    cpy3 = cpy - y3(k,l);
                    cpy4 = cpy - y4(k,l);
                    e1 = cpx1^2+cpz^2;
                    e2 = cpx2^2+cpz^2;
                    e3 = cpx3^2+cpz^2;
                    e4 = cpx4^2+cpz^2;
                    r1 = realsqrt(e1 + cpy1^2);
                    r2 = realsqrt(e2 + cpy2^2);
                    r3 = realsqrt(e3 + cpy3^2);
                    r4 = realsqrt(e4 + cpy4^2);
                    h1 = cpx1*cpy1;
                    h2 = cpx2*cpy2;
                    h3 = cpx3*cpy3;
                    h4 = cpx4*cpy4;
                    x21 = x2(k,l)-x1(k,l);
                    x32 = x3(k,l)-x2(k,l);
                    x43 = x4(k,l)-x3(k,l);
                    x14 = x1(k,l)-x4(k,l);
                    y21 = y2(k,l)-y1(k,l);
                    y32 = y3(k,l)-y2(k,l);
                    y43 = y4(k,l)-y3(k,l);
                    y14 = y1(k,l)-y4(k,l);
                    if d1(k,l) < ep
                        a1 = 0;
                        b1 = 0;
                    else
                        F = y21*e1 - x21*h1;
                        G = y21*e2 - x21*h2;
                        a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        b1 = (cpx1*y21-cpy1*x21)/d1(k,l)*reallog((r1+r2+d1(k,l))/(r1+r2-d1(k,l)));
                    end
                    if d2(k,l) < ep
                        a2 = 0;
                        b2 = 0;
                    else
                        F = y32*e2 - x32*h2;
                        G = y32*e3 - x32*h3;
                        a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        b2 = (cpx2*y32-cpy2*x32)/d2(k,l)*reallog((r2+r3+d2(k,l))/(r2+r3-d2(k,l)));
                    end
                    if d3(k,l) < ep
                        a3 = 0;
                        b3 = 0;
                    else
                        F = y43*e3 - x43*h3;
                        G = y43*e4 - x43*h4;
                        a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        b3 = (cpx3*y43-cpy3*x43)/d3(k,l)*reallog((r3+r4+d3(k,l))/(r3+r4-d3(k,l)));
                    end
                    if d4(k,l) < ep
                        a4 = 0;
                        b4 = 0;
                    else
                        F = y14*e4 - x14*h4;
                        G = y14*e1 - x14*h1;
                        a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        b4 = (cpx4*y14-cpy4*x14)/d4(k,l)*reallog((r4+r1+d4(k,l))/(r4+r1-d4(k,l)));
                    end
                    dipol = -(a1+a2+a3+a4)*0.079577471545948;
                    if abs(cpz) < ep
                        dipol = 0;
                    end
                    b(I) = -(b1+b2+b3+b4)*0.079577471545948-cpz*dipol;
                    a(I) = dipol;
                end
            end
        end
    end
end

% calculation of trail wake influence coefficients
I = 0;
atrag = zeros(Mdruga*Ndruga,M*N);
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                if k == 1
                    cxijcxN1l = cxdruga(i,j)-cx(N1,l);
                    cyijcyN1l = cydruga(i,j)-cy(N1,l);
                    czijczN1l = czdruga(i,j)-cz(N1,l);
                    cpx = cxijcxN1l*u1(N1,l) + cyijcyN1l*u2(N1,l) + czijczN1l*u3(N1,l);
                    cpy = cxijcxN1l*o1(N1,l) + cyijcyN1l*o2(N1,l) + czijczN1l*o3(N1,l);
                    cpz = cxijcxN1l*n1(N1,l) + cyijcyN1l*n2(N1,l) + czijczN1l*n3(N1,l);
                    if abs(cpz) < ep
                        atrag(I) = 0;
                    else
                        cpx1 = cpx - x1(N1,l);
                        cpx2 = cpx - x2(N1,l);
                        cpx3 = cpx - x3(N1,l);
                        cpx4 = cpx - x4(N1,l);
                        cpy1 = cpy - y1(N1,l);
                        cpy2 = cpy - y2(N1,l);
                        cpy3 = cpy - y3(N1,l);
                        cpy4 = cpy - y4(N1,l);
                        e1 = cpx1^2+cpz^2;
                        e2 = cpx2^2+cpz^2;
                        e3 = cpx3^2+cpz^2;
                        e4 = cpx4^2+cpz^2;
                        r1 = realsqrt(e1 + cpy1^2);
                        r2 = realsqrt(e2 + cpy2^2);
                        r3 = realsqrt(e3 + cpy3^2);
                        r4 = realsqrt(e4 + cpy4^2);
                        h1 = cpx1*cpy1;
                        h2 = cpx2*cpy2;
                        h3 = cpx3*cpy3;
                        h4 = cpx4*cpy4;
                        x21 = x2(N1,l)-x1(N1,l);
                        x32 = x3(N1,l)-x2(N1,l);
                        x43 = x4(N1,l)-x3(N1,l);
                        x14 = x1(N1,l)-x4(N1,l);
                        y21 = y2(N1,l)-y1(N1,l);
                        y32 = y3(N1,l)-y2(N1,l);
                        y43 = y4(N1,l)-y3(N1,l);
                        y14 = y1(N1,l)-y4(N1,l);
                        if d1(N1,l) < ep
                            a1 = 0;
                        else
                            F = y21*e1 - x21*h1;
                            G = y21*e2 - x21*h2;
                            a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        end
                        if d2(N1,l) < ep
                            a2 = 0;
                        else
                            F = y32*e2 - x32*h2;
                            G = y32*e3 - x32*h3;
                            a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        end
                        if d3(N1,l) < ep
                            a3 = 0;
                        else
                            F = y43*e3 - x43*h3;
                            G = y43*e4 - x43*h4;
                            a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        end
                        if d4(N1,l) < ep
                            a4 = 0;
                        else
                            F = y14*e4 - x14*h4;
                            G = y14*e1 - x14*h1;
                            a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        end
                        atrag(I) = -(a1+a2+a3+a4)*0.079577471545948;
                    end
                else
                    atrag(I) = 0;
                end
            end
        end
    end
end
atrag(1:Mdruga*Ndruga,M*N-M+1:O) = -atrag(1:Mdruga*Ndruga,1:M);

atotal = a-atrag;



% file influence_other_nolift.m

function [a,b]=influence_other_nolift(FF,ep,S,M,N,u1,u2,u3,o1,o2,o3,n1,n2,n3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4,Mdruga,Ndruga,cxdruga,cydruga,czdruga)

% calculation of influence coefficients
a = zeros(Mdruga*Ndruga,M*N);
b = zeros(Mdruga*Ndruga,M*N);
I = 0;
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                cxijcxkl = cxdruga(i,j)-cx(k,l);
                cyijcykl = cydruga(i,j)-cy(k,l);
                czijczkl = czdruga(i,j)-cz(k,l);
                cpx = cxijcxkl*u1(k,l) + cyijcykl*u2(k,l) + czijczkl*u3(k,l);
                cpy = cxijcxkl*o1(k,l) + cyijcykl*o2(k,l) + czijczkl*o3(k,l);
                cpz = cxijcxkl*n1(k,l) + cyijcykl*n2(k,l) + czijczkl*n3(k,l);
                % if distance of panel from influenced point is greater
                % then product of longer diagonal and "far field" coefficient
                if realsqrt(cpx^2+cpy^2+cpz^2) > FF(k,l)
                    rad = cpx^2 + cpy^2 + cpz^2;
                    a(I) = 0.079577471545948*S(k,l)*cpz*rad^(-1.5);
                    b(I) = 0.079577471545948*S(k,l)/realsqrt(rad);
                else
                    cpx1 = cpx - x1(k,l);
                    cpx2 = cpx - x2(k,l);
                    cpx3 = cpx - x3(k,l);
                    cpx4 = cpx - x4(k,l);
                    cpy1 = cpy - y1(k,l);
                    cpy2 = cpy - y2(k,l);
                    cpy3 = cpy - y3(k,l);
                    cpy4 = cpy - y4(k,l);
                    e1 = cpx1^2+cpz^2;
                    e2 = cpx2^2+cpz^2;
                    e3 = cpx3^2+cpz^2;
                    e4 = cpx4^2+cpz^2;
                    r1 = realsqrt(e1 + cpy1^2);
                    r2 = realsqrt(e2 + cpy2^2);
                    r3 = realsqrt(e3 + cpy3^2);
                    r4 = realsqrt(e4 + cpy4^2);
                    h1 = cpx1*cpy1;
                    h2 = cpx2*cpy2;
                    h3 = cpx3*cpy3;
                    h4 = cpx4*cpy4;
                    x21 = x2(k,l)-x1(k,l);
                    x32 = x3(k,l)-x2(k,l);
                    x43 = x4(k,l)-x3(k,l);
                    x14 = x1(k,l)-x4(k,l);
                    y21 = y2(k,l)-y1(k,l);
                    y32 = y3(k,l)-y2(k,l);
                    y43 = y4(k,l)-y3(k,l);
                    y14 = y1(k,l)-y4(k,l);
                    if d1(k,l) < ep
                        a1 = 0;
                        b1 = 0;
                    else
                        F = y21*e1 - x21*h1;
                        G = y21*e2 - x21*h2;
                        a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        b1 = (cpx1*y21-cpy1*x21)/d1(k,l)*reallog((r1+r2+d1(k,l))/(r1+r2-d1(k,l)));
                    end
                    if d2(k,l) < ep
                        a2 = 0;
                        b2 = 0;
                    else
                        F = y32*e2 - x32*h2;
                        G = y32*e3 - x32*h3;
                        a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        b2 = (cpx2*y32-cpy2*x32)/d2(k,l)*reallog((r2+r3+d2(k,l))/(r2+r3-d2(k,l)));
                    end
                    if d3(k,l) < ep
                        a3 = 0;
                        b3 = 0;
                    else
                        F = y43*e3 - x43*h3;
                        G = y43*e4 - x43*h4;
                        a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        b3 = (cpx3*y43-cpy3*x43)/d3(k,l)*reallog((r3+r4+d3(k,l))/(r3+r4-d3(k,l)));
                    end
                    if d4(k,l) < ep
                        a4 = 0;
                        b4 = 0;
                    else
                        F = y14*e4 - x14*h4;
                        G = y14*e1 - x14*h1;
                        a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        b4 = (cpx4*y14-cpy4*x14)/d4(k,l)*reallog((r4+r1+d4(k,l))/(r4+r1-d4(k,l)));
                    end
                    dipol = -(a1+a2+a3+a4)*0.079577471545948;
                    if abs(cpz) < ep
                        dipol = 0;
                    end
                    b(I) = -(b1+b2+b3+b4)*0.079577471545948-cpz*dipol;
                    a(I) = dipol;
                end
            end
        end
    end
end


% file influence_self_lift.m

function [atotal,b,sigma]=influence_self_lift(FF,ep,Vx,Vy,Vz,S,M,N,N1,O,u1,u2,u3,o1,o2,o3,n1,n2,n3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4)

% calculation of influence coefficients
a = zeros(M*N,M*N);
b = zeros(M*N,M*N);
I = 0;
for k = 1:N
    for l = 1:M
        for i = 1:N
            for j = 1:M
                I = I+1;
                cxijcxkl = cx(i,j)-cx(k,l);
                cyijcykl = cy(i,j)-cy(k,l);
                czijczkl = cz(i,j)-cz(k,l);
                cpx = cxijcxkl*u1(k,l) + cyijcykl*u2(k,l) + czijczkl*u3(k,l);
                cpy = cxijcxkl*o1(k,l) + cyijcykl*o2(k,l) + czijczkl*o3(k,l);
                cpz = cxijcxkl*n1(k,l) + cyijcykl*n2(k,l) + czijczkl*n3(k,l);
                % if distance of panel from influenced point is greater
                % then product of longer diagonal and "far field" coefficient
                if realsqrt(cpx^2+cpy^2+cpz^2) > FF(k,l)
                    rad = cpx^2 + cpy^2 + cpz^2;
                    a(I) = 0.079577471545948*S(k,l)*cpz*rad^(-1.5);
                    b(I) = 0.079577471545948*S(k,l)/realsqrt(rad);
                else
                    cpx1 = cpx - x1(k,l);
                    cpx2 = cpx - x2(k,l);
                    cpx3 = cpx - x3(k,l);
                    cpx4 = cpx - x4(k,l);
                    cpy1 = cpy - y1(k,l);
                    cpy2 = cpy - y2(k,l);
                    cpy3 = cpy - y3(k,l);
                    cpy4 = cpy - y4(k,l);
                    e1 = cpx1^2+cpz^2;
                    e2 = cpx2^2+cpz^2;
                    e3 = cpx3^2+cpz^2;
                    e4 = cpx4^2+cpz^2;
                    r1 = realsqrt(e1 + cpy1^2);
                    r2 = realsqrt(e2 + cpy2^2);
                    r3 = realsqrt(e3 + cpy3^2);
                    r4 = realsqrt(e4 + cpy4^2);
                    h1 = cpx1*cpy1;
                    h2 = cpx2*cpy2;
                    h3 = cpx3*cpy3;
                    h4 = cpx4*cpy4;
                    x21 = x2(k,l)-x1(k,l);
                    x32 = x3(k,l)-x2(k,l);
                    x43 = x4(k,l)-x3(k,l);
                    x14 = x1(k,l)-x4(k,l);
                    y21 = y2(k,l)-y1(k,l);
                    y32 = y3(k,l)-y2(k,l);
                    y43 = y4(k,l)-y3(k,l);
                    y14 = y1(k,l)-y4(k,l);
                    if d1(k,l) < ep
                        a1 = 0;
                        b1 = 0;
                    else
                        F = y21*e1 - x21*h1;
                        G = y21*e2 - x21*h2;
                        a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        b1 = (cpx1*y21-cpy1*x21)/d1(k,l)*reallog((r1+r2+d1(k,l))/(r1+r2-d1(k,l)));
                    end
                    if d2(k,l) < ep
                        a2 = 0;
                        b2 = 0;
                    else
                        F = y32*e2 - x32*h2;
                        G = y32*e3 - x32*h3;
                        a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        b2 = (cpx2*y32-cpy2*x32)/d2(k,l)*reallog((r2+r3+d2(k,l))/(r2+r3-d2(k,l)));
                    end
                    if d3(k,l) < ep
                        a3 = 0;
                        b3 = 0;
                    else
                        F = y43*e3 - x43*h3;
                        G = y43*e4 - x43*h4;
                        a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        b3 = (cpx3*y43-cpy3*x43)/d3(k,l)*reallog((r3+r4+d3(k,l))/(r3+r4-d3(k,l)));
                    end
                    if d4(k,l) < ep
                        a4 = 0;
                        b4 = 0;
                    else
                        F = y14*e4 - x14*h4;
                        G = y14*e1 - x14*h1;
                        a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        b4 = (cpx4*y14-cpy4*x14)/d4(k,l)*reallog((r4+r1+d4(k,l))/(r4+r1-d4(k,l)));
                    end
                    dipol = -(a1+a2+a3+a4)*0.079577471545948;
                    if abs(cpz) < ep
                        dipol = 0;
                    end
                    b(I) = -(b1+b2+b3+b4)*0.079577471545948-cpz*dipol;
                    if i == k && j == l
                        dipol = -0.5;
                    end
                    a(I) = dipol;
                end
            end
        end
    end
end

% calculation of trail wake influence coefficients
I = 0;
atrag = zeros(M*N,M*N);
for k = 1:N
    for l = 1:M
        for i = 1:N
            for j = 1:M
                I = I+1;
                if k == 1
                    cxijcxN1l = cx(i,j)-cx(N1,l);
                    cyijcyN1l = cy(i,j)-cy(N1,l);
                    czijczN1l = cz(i,j)-cz(N1,l);
                    cpx = cxijcxN1l*u1(N1,l) + cyijcyN1l*u2(N1,l) + czijczN1l*u3(N1,l);
                    cpy = cxijcxN1l*o1(N1,l) + cyijcyN1l*o2(N1,l) + czijczN1l*o3(N1,l);
                    cpz = cxijcxN1l*n1(N1,l) + cyijcyN1l*n2(N1,l) + czijczN1l*n3(N1,l);
                    if abs(cpz) < ep
                        atrag(I) = 0;
                    else
                        cpx1 = cpx - x1(N1,l);
                        cpx2 = cpx - x2(N1,l);
                        cpx3 = cpx - x3(N1,l);
                        cpx4 = cpx - x4(N1,l);
                        cpy1 = cpy - y1(N1,l);
                        cpy2 = cpy - y2(N1,l);
                        cpy3 = cpy - y3(N1,l);
                        cpy4 = cpy - y4(N1,l);
                        e1 = cpx1^2+cpz^2;
                        e2 = cpx2^2+cpz^2;
                        e3 = cpx3^2+cpz^2;
                        e4 = cpx4^2+cpz^2;
                        r1 = realsqrt(e1 + cpy1^2);
                        r2 = realsqrt(e2 + cpy2^2);
                        r3 = realsqrt(e3 + cpy3^2);
                        r4 = realsqrt(e4 + cpy4^2);
                        h1 = cpx1*cpy1;
                        h2 = cpx2*cpy2;
                        h3 = cpx3*cpy3;
                        h4 = cpx4*cpy4;
                        x21 = x2(N1,l)-x1(N1,l);
                        x32 = x3(N1,l)-x2(N1,l);
                        x43 = x4(N1,l)-x3(N1,l);
                        x14 = x1(N1,l)-x4(N1,l);
                        y21 = y2(N1,l)-y1(N1,l);
                        y32 = y3(N1,l)-y2(N1,l);
                        y43 = y4(N1,l)-y3(N1,l);
                        y14 = y1(N1,l)-y4(N1,l);
                        if d1(N1,l) < ep
                            a1 = 0;
                        else
                            F = y21*e1 - x21*h1;
                            G = y21*e2 - x21*h2;
                            a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        end
                        if d2(N1,l) < ep
                            a2 = 0;
                        else
                            F = y32*e2 - x32*h2;
                            G = y32*e3 - x32*h3;
                            a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        end
                        if d3(N1,l) < ep
                            a3 = 0;
                        else
                            F = y43*e3 - x43*h3;
                            G = y43*e4 - x43*h4;
                            a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        end
                        if d4(N1,l) < ep
                            a4 = 0;
                        else
                            F = y14*e4 - x14*h4;
                            G = y14*e1 - x14*h1;
                            a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        end
                        atrag(I) = -(a1+a2+a3+a4)*0.079577471545948;
                    end
                else
                    atrag(I) = 0;
                end
            end
        end
    end
end
atrag(1:O,O-M+1:O) = -atrag(1:O,1:M);

atotal = a-atrag;

% calculation of source strengths
K = 0;
sigma = zeros(1,O);
for i = 1:N
    for j = 1:M
        K = K+1;
        sigma(K) = n1(i,j)*Vx + n2(i,j)*Vy + n3(i,j)*Vz;
    end
end



% file influence_other_nolift.m

function [a,b]=influence_other_nolift(FF,ep,S,M,N,u1,u2,u3,o1,o2,o3,n1,n2,n3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4,Mdruga,Ndruga,cxdruga,cydruga,czdruga)

% calculation of influence coefficients
a = zeros(Mdruga*Ndruga,M*N);
b = zeros(Mdruga*Ndruga,M*N);
I = 0;
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                cxijcxkl = cxdruga(i,j)-cx(k,l);
                cyijcykl = cydruga(i,j)-cy(k,l);
                czijczkl = czdruga(i,j)-cz(k,l);
                cpx = cxijcxkl*u1(k,l) + cyijcykl*u2(k,l) + czijczkl*u3(k,l);
                cpy = cxijcxkl*o1(k,l) + cyijcykl*o2(k,l) + czijczkl*o3(k,l);
                cpz = cxijcxkl*n1(k,l) + cyijcykl*n2(k,l) + czijczkl*n3(k,l);
                % if distance of panel from influenced point is greater
                % then product of longer diagonal and "far field" coefficient
                if realsqrt(cpx^2+cpy^2+cpz^2) > FF(k,l)
                    rad = cpx^2 + cpy^2 + cpz^2;
                    a(I) = 0.079577471545948*S(k,l)*cpz*rad^(-1.5);
                    b(I) = 0.079577471545948*S(k,l)/realsqrt(rad);
                else
                    cpx1 = cpx - x1(k,l);
                    cpx2 = cpx - x2(k,l);
                    cpx3 = cpx - x3(k,l);
                    cpx4 = cpx - x4(k,l);
                    cpy1 = cpy - y1(k,l);
                    cpy2 = cpy - y2(k,l);
                    cpy3 = cpy - y3(k,l);
                    cpy4 = cpy - y4(k,l);
                    e1 = cpx1^2+cpz^2;
                    e2 = cpx2^2+cpz^2;
                    e3 = cpx3^2+cpz^2;
                    e4 = cpx4^2+cpz^2;
                    r1 = realsqrt(e1 + cpy1^2);
                    r2 = realsqrt(e2 + cpy2^2);
                    r3 = realsqrt(e3 + cpy3^2);
                    r4 = realsqrt(e4 + cpy4^2);
                    h1 = cpx1*cpy1;
                    h2 = cpx2*cpy2;
                    h3 = cpx3*cpy3;
                    h4 = cpx4*cpy4;
                    x21 = x2(k,l)-x1(k,l);
                    x32 = x3(k,l)-x2(k,l);
                    x43 = x4(k,l)-x3(k,l);
                    x14 = x1(k,l)-x4(k,l);
                    y21 = y2(k,l)-y1(k,l);
                    y32 = y3(k,l)-y2(k,l);
                    y43 = y4(k,l)-y3(k,l);
                    y14 = y1(k,l)-y4(k,l);
                    if d1(k,l) < ep
                        a1 = 0;
                        b1 = 0;
                    else
                        F = y21*e1 - x21*h1;
                        G = y21*e2 - x21*h2;
                        a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        b1 = (cpx1*y21-cpy1*x21)/d1(k,l)*reallog((r1+r2+d1(k,l))/(r1+r2-d1(k,l)));
                    end
                    if d2(k,l) < ep
                        a2 = 0;
                        b2 = 0;
                    else
                        F = y32*e2 - x32*h2;
                        G = y32*e3 - x32*h3;
                        a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        b2 = (cpx2*y32-cpy2*x32)/d2(k,l)*reallog((r2+r3+d2(k,l))/(r2+r3-d2(k,l)));
                    end
                    if d3(k,l) < ep
                        a3 = 0;
                        b3 = 0;
                    else
                        F = y43*e3 - x43*h3;
                        G = y43*e4 - x43*h4;
                        a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        b3 = (cpx3*y43-cpy3*x43)/d3(k,l)*reallog((r3+r4+d3(k,l))/(r3+r4-d3(k,l)));
                    end
                    if d4(k,l) < ep
                        a4 = 0;
                        b4 = 0;
                    else
                        F = y14*e4 - x14*h4;
                        G = y14*e1 - x14*h1;
                        a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        b4 = (cpx4*y14-cpy4*x14)/d4(k,l)*reallog((r4+r1+d4(k,l))/(r4+r1-d4(k,l)));
                    end
                    dipol = -(a1+a2+a3+a4)*0.079577471545948;
                    if abs(cpz) < ep
                        dipol = 0;
                    end
                    b(I) = -(b1+b2+b3+b4)*0.079577471545948-cpz*dipol;
                    a(I) = dipol;
                end
            end
        end
    end
end


% file influence_other_lift.m

function [atotal,b]=influence_other_lift(FF,ep,S,M,N,N1,O,u1,u2,u3,o1,o2,o3,n1,n2,n3,cx,cy,cz,x1,y1,x2,y2,x3,y3,x4,y4,d1,d2,d3,d4,Mdruga,Ndruga,cxdruga,cydruga,czdruga)

% calculation of influence coefficients
a = zeros(Mdruga*Ndruga,M*N);
b = zeros(Mdruga*Ndruga,M*N);
I = 0;
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                cxijcxkl = cxdruga(i,j)-cx(k,l);
                cyijcykl = cydruga(i,j)-cy(k,l);
                czijczkl = czdruga(i,j)-cz(k,l);
                cpx = cxijcxkl*u1(k,l) + cyijcykl*u2(k,l) + czijczkl*u3(k,l);
                cpy = cxijcxkl*o1(k,l) + cyijcykl*o2(k,l) + czijczkl*o3(k,l);
                cpz = cxijcxkl*n1(k,l) + cyijcykl*n2(k,l) + czijczkl*n3(k,l);
                % if distance of panel from influenced point is greater
                % then product of longer diagonal and "far field" coefficient
                if realsqrt(cpx^2+cpy^2+cpz^2) > FF(k,l)
                    rad = cpx^2 + cpy^2 + cpz^2;
                    a(I) = 0.079577471545948*S(k,l)*cpz*rad^(-1.5);
                    b(I) = 0.079577471545948*S(k,l)/realsqrt(rad);
                else
                    cpx1 = cpx - x1(k,l);
                    cpx2 = cpx - x2(k,l);
                    cpx3 = cpx - x3(k,l);
                    cpx4 = cpx - x4(k,l);
                    cpy1 = cpy - y1(k,l);
                    cpy2 = cpy - y2(k,l);
                    cpy3 = cpy - y3(k,l);
                    cpy4 = cpy - y4(k,l);
                    e1 = cpx1^2+cpz^2;
                    e2 = cpx2^2+cpz^2;
                    e3 = cpx3^2+cpz^2;
                    e4 = cpx4^2+cpz^2;
                    r1 = realsqrt(e1 + cpy1^2);
                    r2 = realsqrt(e2 + cpy2^2);
                    r3 = realsqrt(e3 + cpy3^2);
                    r4 = realsqrt(e4 + cpy4^2);
                    h1 = cpx1*cpy1;
                    h2 = cpx2*cpy2;
                    h3 = cpx3*cpy3;
                    h4 = cpx4*cpy4;
                    x21 = x2(k,l)-x1(k,l);
                    x32 = x3(k,l)-x2(k,l);
                    x43 = x4(k,l)-x3(k,l);
                    x14 = x1(k,l)-x4(k,l);
                    y21 = y2(k,l)-y1(k,l);
                    y32 = y3(k,l)-y2(k,l);
                    y43 = y4(k,l)-y3(k,l);
                    y14 = y1(k,l)-y4(k,l);
                    if d1(k,l) < ep
                        a1 = 0;
                        b1 = 0;
                    else
                        F = y21*e1 - x21*h1;
                        G = y21*e2 - x21*h2;
                        a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        b1 = (cpx1*y21-cpy1*x21)/d1(k,l)*reallog((r1+r2+d1(k,l))/(r1+r2-d1(k,l)));
                    end
                    if d2(k,l) < ep
                        a2 = 0;
                        b2 = 0;
                    else
                        F = y32*e2 - x32*h2;
                        G = y32*e3 - x32*h3;
                        a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        b2 = (cpx2*y32-cpy2*x32)/d2(k,l)*reallog((r2+r3+d2(k,l))/(r2+r3-d2(k,l)));
                    end
                    if d3(k,l) < ep
                        a3 = 0;
                        b3 = 0;
                    else
                        F = y43*e3 - x43*h3;
                        G = y43*e4 - x43*h4;
                        a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        b3 = (cpx3*y43-cpy3*x43)/d3(k,l)*reallog((r3+r4+d3(k,l))/(r3+r4-d3(k,l)));
                    end
                    if d4(k,l) < ep
                        a4 = 0;
                        b4 = 0;
                    else
                        F = y14*e4 - x14*h4;
                        G = y14*e1 - x14*h1;
                        a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        b4 = (cpx4*y14-cpy4*x14)/d4(k,l)*reallog((r4+r1+d4(k,l))/(r4+r1-d4(k,l)));
                    end
                    dipol = -(a1+a2+a3+a4)*0.079577471545948;
                    if abs(cpz) < ep
                        dipol = 0;
                    end
                    b(I) = -(b1+b2+b3+b4)*0.079577471545948-cpz*dipol;
                    a(I) = dipol;
                end
            end
        end
    end
end

% calculation of trail wake influence coefficients
I = 0;
atrag = zeros(Mdruga*Ndruga,M*N);
for k = 1:N
    for l = 1:M
        for i = 1:Ndruga
            for j = 1:Mdruga
                I = I+1;
                if k == 1
                    cxijcxN1l = cxdruga(i,j)-cx(N1,l);
                    cyijcyN1l = cydruga(i,j)-cy(N1,l);
                    czijczN1l = czdruga(i,j)-cz(N1,l);
                    cpx = cxijcxN1l*u1(N1,l) + cyijcyN1l*u2(N1,l) + czijczN1l*u3(N1,l);
                    cpy = cxijcxN1l*o1(N1,l) + cyijcyN1l*o2(N1,l) + czijczN1l*o3(N1,l);
                    cpz = cxijcxN1l*n1(N1,l) + cyijcyN1l*n2(N1,l) + czijczN1l*n3(N1,l);
                    if abs(cpz) < ep
                        atrag(I) = 0;
                    else
                        cpx1 = cpx - x1(N1,l);
                        cpx2 = cpx - x2(N1,l);
                        cpx3 = cpx - x3(N1,l);
                        cpx4 = cpx - x4(N1,l);
                        cpy1 = cpy - y1(N1,l);
                        cpy2 = cpy - y2(N1,l);
                        cpy3 = cpy - y3(N1,l);
                        cpy4 = cpy - y4(N1,l);
                        e1 = cpx1^2+cpz^2;
                        e2 = cpx2^2+cpz^2;
                        e3 = cpx3^2+cpz^2;
                        e4 = cpx4^2+cpz^2;
                        r1 = realsqrt(e1 + cpy1^2);
                        r2 = realsqrt(e2 + cpy2^2);
                        r3 = realsqrt(e3 + cpy3^2);
                        r4 = realsqrt(e4 + cpy4^2);
                        h1 = cpx1*cpy1;
                        h2 = cpx2*cpy2;
                        h3 = cpx3*cpy3;
                        h4 = cpx4*cpy4;
                        x21 = x2(N1,l)-x1(N1,l);
                        x32 = x3(N1,l)-x2(N1,l);
                        x43 = x4(N1,l)-x3(N1,l);
                        x14 = x1(N1,l)-x4(N1,l);
                        y21 = y2(N1,l)-y1(N1,l);
                        y32 = y3(N1,l)-y2(N1,l);
                        y43 = y4(N1,l)-y3(N1,l);
                        y14 = y1(N1,l)-y4(N1,l);
                        if d1(N1,l) < ep
                            a1 = 0;
                        else
                            F = y21*e1 - x21*h1;
                            G = y21*e2 - x21*h2;
                            a1 = atan2(cpz*x21*(F*r2-G*r1), cpz^2*x21^2*r1*r2+F*G);
                        end
                        if d2(N1,l) < ep
                            a2 = 0;
                        else
                            F = y32*e2 - x32*h2;
                            G = y32*e3 - x32*h3;
                            a2 = atan2(cpz*x32*(F*r3-G*r2), cpz^2*x32^2*r2*r3+F*G);
                        end
                        if d3(N1,l) < ep
                            a3 = 0;
                        else
                            F = y43*e3 - x43*h3;
                            G = y43*e4 - x43*h4;
                            a3 = atan2(cpz*x43*(F*r4-G*r3), cpz^2*x43^2*r3*r4+F*G);
                        end
                        if d4(N1,l) < ep
                            a4 = 0;
                        else
                            F = y14*e4 - x14*h4;
                            G = y14*e1 - x14*h1;
                            a4 = atan2(cpz*x14*(F*r1-G*r4), cpz^2*x14^2*r4*r1+F*G);
                        end
                        atrag(I) = -(a1+a2+a3+a4)*0.079577471545948;
                    end
                else
                    atrag(I) = 0;
                end
            end
        end
    end
end
atrag(1:Mdruga*Ndruga,M*N-M+1:O) = -atrag(1:Mdruga*Ndruga,1:M);

atotal = a-atrag;


% file speed_pressure_force.m

function [v,vx,vy,vz,cp,CX,CY,CZ,CL,CM,CN]=speed_pressure_force(c,span,Sw,gam,V,ro,Vx,Vy,Vz,S,M,N,u1,u2,u3,n1,n2,n3,p1,p2,p3,o1,o2,o3,cx,cy,cz)

% calculation of speeds, pressures and forces
FX = 0;
FY = 0;
FZ = 0;
FL = 0;
FM = 0;
FN = 0;
vx = zeros(N,M);
vy = zeros(N,M);
vz = zeros(N,M);
v = zeros(N,M);
cp = zeros(N,M);
q = 0.5*ro*V^2;
for j = 1:M
    for i = 1:N
        % calculation of induced speeds
        % boundary panels - first order interpolation
        if i == 1
            dx = cx(i+1,j)-cx(i,j);
            dy = cy(i+1,j)-cy(i,j);
            dz = cz(i+1,j)-cz(i,j);
            dr = sqrt(dx^2+dy^2+dz^2);
            qu = (gam(i+1,j)-gam(i,j))/dr;
        end
        if i == N
            dx = cx(i,j)-cx(i-1,j);
            dy = cy(i,j)-cy(i-1,j);
            dz = cz(i,j)-cz(i-1,j);
            dr = sqrt(dx^2+dy^2+dz^2);
            qu = (gam(i,j)-gam(i-1,j))/dr;
        end
        if j == 1
            dx = cx(i,j+1)-cx(i,j);
            dy = cy(i,j+1)-cy(i,j);
            dz = cz(i,j+1)-cz(i,j);
            dr = sqrt(dx^2+dy^2+dz^2);
            qp = (gam(i,j+1)-gam(i,j))/dr;
        end
        if j == M
            dx = cx(i,j)-cx(i,j-1);
            dy = cy(i,j)-cy(i,j-1);
            dz = cz(i,j)-cz(i,j-1);
            dr = sqrt(dx^2+dy^2+dz^2);
            qp = (gam(i,j)-gam(i,j-1))/dr;
        end
        if i ~= 1 && i ~= N
            % inner panels - second order interpolation
            % longitudinal
            dx = cx(i+1,j)-cx(i,j);
            dy = cy(i+1,j)-cy(i,j);
            dz = cz(i+1,j)-cz(i,j);
            drupwind = sqrt(dx^2+dy^2+dz^2);
            dx = cx(i,j)-cx(i-1,j);
            dy = cy(i,j)-cy(i-1,j);
            dz = cz(i,j)-cz(i-1,j);
            drdownwind = sqrt(dx^2+dy^2+dz^2);
            pu = polyfit( [-drdownwind, 0, drupwind], [gam(i-1,j), gam(i,j), gam(i+1,j)], 2 );
            qu = pu(2);
        end
        if j ~= 1 && j ~= M
            % transversal
            dx = cx(i,j+1)-cx(i,j);
            dy = cy(i,j+1)-cy(i,j);
            dz = cz(i,j+1)-cz(i,j);
            drupwind = sqrt(dx^2+dy^2+dz^2);
            dx = cx(i,j)-cx(i,j-1);
            dy = cy(i,j)-cy(i,j-1);
            dz = cz(i,j)-cz(i,j-1);
            drdownwind = sqrt(dx^2+dy^2+dz^2);
            pp = polyfit( [-drdownwind, 0, drupwind], [gam(i,j-1), gam(i,j), gam(i,j+1)], 2 );
            qp = pp(2);
        end
        
        qo = (p1(i,j)*o1(i,j) + p2(i,j)*o2(i,j) + p3(i,j)*o3(i,j))*qp;
        
        gu = u1(i,j)*Vx + u2(i,j)*Vy + u3(i,j)*Vz;
        go = o1(i,j)*Vx + o2(i,j)*Vy + o3(i,j)*Vz;
        
        vx(i,j) = (-qu + gu)*u1(i,j) + (-qo + go)*o1(i,j);
        vy(i,j) = (-qu + gu)*u2(i,j) + (-qo + go)*o2(i,j);
        vz(i,j) = (-qu + gu)*u3(i,j) + (-qo + go)*o3(i,j);
        v(i,j) = realsqrt(vx(i,j)^2+vy(i,j)^2+vz(i,j)^2);
        
        cp(i,j) = 1-v(i,j)^2/V^2;
        dX = -cp(i,j)*S(i,j)*n1(i,j)*q;
        dY = -cp(i,j)*S(i,j)*n2(i,j)*q;
        dZ = -cp(i,j)*S(i,j)*n3(i,j)*q;
        FX = FX + dX;
        FY = FY + dY;
        FZ = FZ + dZ;
        FL = FL              - dY*cz(i,j) + dZ*cy(i,j);
        FM = FM + dX*cz(i,j)              - dZ*cx(i,j);
        FN = FN - dX*cy(i,j) + dY*cx(i,j);             
    end
end

CX = FX/q/Sw;
CY = FY/q/Sw;
CZ = FZ/q/Sw;
CL = FL/q/Sw/span;
CM = FM/q/Sw/c;
CN = FN/q/Sw/span;
